import{r as p,j as e,a as ie}from"./react-Tf5a63N3.js";import{c as de}from"./react-dom-L-9RVvDo.js";import{L as ce,B as me}from"./react-router-dom-XpqpMlL4.js";import{s as g,S as C,I as T,B as x,P as L,A as he,F as d,a as G,D as ue,b as K,c as N,d as pe,R as xe,C as w,e as ge,T as W,L as F,f as ye,g as je,z as fe}from"./antd-GH_AtSMw.js";import{d as I}from"./dayjs-I44_pL56.js";import{a as Ee}from"./axios-IkzXrfrG.js";import{c as Te}from"./@wxcloud-VArnRXkh.js";import{l as be}from"./lodash-MYjC_vaG.js";import{C as j}from"./crypto-js-cnNLbfBj.js";import{a as Ce,O as Ie,d as we,e as v}from"./react-router-HlPHIle8.js";import{u as Se,a as Ae,b as J,c as Pe,d as _}from"./ahooks-XqKTiDhy.js";import{L as De}from"./rc-virtual-list-BXD3VVHE.js";import{Z as ke,m as Ue,c as ve,u as Re}from"./@wangeditor-gzx6jVfq.js";import{D as Ne,O as Le}from"./@ant-design-G0262HYq.js";import"./@babel-fXcOJB-X.js";import"./scheduler-iwWdm5Ml.js";import"./@remix-run-1q7uUoWE.js";import"./rc-util-44hGjeVP.js";import"./react-is-q81m-9gd.js";import"./classnames-RRvKwVVO.js";import"./rc-resize-observer-ck5JqIRG.js";import"./resize-observer-polyfill-B32NGzNS.js";import"./rc-motion-7vv53bTg.js";import"./rc-picker-xixrHE6j.js";import"./@rc-component-oibO48Qt.js";import"./rc-menu-Q3iJPZGu.js";import"./rc-overflow-VxRkfzAh.js";import"./rc-select-WtCpbyab.js";import"./@ctrl-_Y40OLZn.js";import"./rc-drawer-fZgySpmT.js";import"./rc-field-form-Rdl82lVd.js";import"./async-validator-BHjhHa7C.js";import"./rc-notification-7I1nwpoC.js";import"./rc-tooltip-dc6ms-Ot.js";import"./rc-table-PhNwxsIQ.js";import"./rc-tree-xZ6JQgv9.js";import"./rc-checkbox-bfzdVFQB.js";import"./rc-dropdown-QKhfUTW0.js";import"./rc-pagination-6SoAqjZS.js";import"./throttle-debounce-5p4B7Tol.js";import"./copy-to-clipboard-ds7YnVhZ.js";import"./toggle-selection-fekekO1r.js";import"./rc-textarea-Ly7unUNs.js";import"./rc-input-zn8sb5C_.js";import"./tslib-9i2l26Ba.js";import"./@emotion-folQEnri.js";import"./stylis-3miXmfPm.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();const X={loading:!1,list:[],tags:[],records:[]},Fe=(t,a)=>{switch(a.type){case"UPDATE":return{...t,...a.payload||{}};default:return t}},b=p.createContext({state:X,dispatch:()=>{}});g.config({top:100,duration:3,maxCount:1});const Oe=Te.initCloud(),Z=Oe.Cloud({identityless:!0,resourceAppid:"wxf18966ace3bbbd97",resourceEnv:"prod-3gjeiq7x1fbed11e"});Z.init();localStorage.getItem("USE_LOCAL_SERVICE")||localStorage.setItem("USE_LOCAL_SERVICE","1");localStorage.getItem("BASE_URL")||localStorage.setItem("BASE_URL","http://localhost:3000");const H=localStorage.getItem("BASE_URL"),Be=(localStorage.getItem("USE_LOCAL_SERVICE")||"0")==="0",Ye=Be&&H?H:"https://ndzy-server.vercel.app",Y=Ee.create({baseURL:Ye,timeout:6e4,withCredentials:!1});Y.interceptors.request.use(t=>{const a=localStorage.getItem("token");return a&&(t.headers={Authorization:"Basic "+a}),t},t=>{Promise.reject(t)});Y.interceptors.response.use(t=>{const a=t.data;return t.data.status===1&&g.error(t.data.msg),t.data.status===0&&g.success(t.data.msg),a},t=>{let a="";if(t&&t.response)switch(t.response.status){case 302:a="接口重定向了！",g.error(a);break;case 400:a="参数不正确！",g.error(a);break;case 401:a="您未登录，或者登录已经超时，请先登录！",console.log("ndzy---log---ndzy",a,"------");break;case 403:a="您没有权限操作！",g.error(a);break;case 404:a=`请求地址出错: ${t.response.config.url}`,g.error(a);break;case 408:a="请求超时！",g.error(a);break;case 409:a="系统已存在相同数据！",g.error(a);break;case 500:a="服务器内部错误！",g.error(a);break;case 501:a="服务未实现！",g.error(a);break;case 502:a="网关错误！",g.error(a);break;case 503:a="服务不可用！",g.error(a);break;case 504:a="服务暂时无法访问，请稍后再试！",g.error(a);break;case 505:a="HTTP 版本不受支持！",g.error(a);break;default:a="异常问题，请联系管理员！",g.error(a);break}return Promise.reject(a)});const Me=t=>Object.keys(t).map(a=>t[a]?`${encodeURIComponent(a)}=${encodeURIComponent(t[a])}`:"").filter(a=>a).join("&"),_e=t=>{const{url:a="",data:s={},params:o={}}=t;let n=a;const r=localStorage.getItem("token"),c={"X-WX-SERVICE":"ndzy-service"};return r&&(c.Authorization="Basic "+r),t.method==="GET"&&!be.isEmpty(o)&&(n+="?"+Me(o)),new Promise((u,i)=>{Z.callContainer({...t,config:{env:"prod-3gjeiq7x1fbed11e"},path:n,header:c,method:t.method,data:s}).then(h=>{h.data.status===1&&g.error(h.data.msg),h.data.status===0&&g.success(h.data.msg),u(h.data)}).catch(()=>{i("网络错误")})})},He=t=>t&&t<I().endOf("day"),Q=()=>{let t=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const o=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?o:o&3|8).toString(16)})},z=()=>{let t="";for(let a=0;a<8;a++)t+=Q().replace(/-/g,"");return t},V=(t,a,s)=>{const o=j.enc.Utf8.parse(a),n=j.enc.Utf8.parse(s),r=j.enc.Hex.parse(t),c=j.enc.Base64.stringify(r);return j.AES.decrypt(c,o,{iv:n,mode:j.mode.CBC,padding:j.pad.Pkcs7,hasher:j.algo.SHA256}).toString(j.enc.Utf8).toString()},R=t=>{const a=z(),s=z(),o=j.enc.Utf8.parse(a),n=j.enc.Utf8.parse(s),r=j.enc.Utf8.parse(t),c=j.AES.encrypt(r,o,{iv:n,mode:j.mode.CBC,padding:j.pad.Pkcs7,hasher:j.algo.SHA256});return{keyBase:a,ivBase:s,text:c.ciphertext.toString().toUpperCase()}},M={labelCol:{xs:{span:6},sm:{span:6}},wrapperCol:{xs:{span:18},sm:{span:18}}},ee={wrapperCol:{span:14,offset:2}},S=()=>{const t=(localStorage.getItem("USE_LOCAL_SERVICE")||"0")==="0"?Y:_e,a=Ce(),{dispatch:s}=p.useContext(b),[o,n]=p.useState(""),r=(l,m={})=>{a(l,{...m})},c=()=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/users/loginInfo",method:"GET"}).then(l=>{s({type:"UPDATE",payload:{user:l.data[0],loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},u=()=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/tags",method:"GET"}).then(l=>{s({type:"UPDATE",payload:{tags:l.data,loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},i=(l={})=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/todos",method:"GET",params:l}).then(m=>{s({type:"UPDATE",payload:{list:m.data.map(f=>({...f,detail:V(f.detail,f.keyBase,f.ivBase)})),loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},h=(l,m)=>{s({type:"UPDATE",payload:{loading:!0}});const{text:f,keyBase:A,ivBase:k}=R(l.detail);t({url:"/todos",method:"POST",data:{...l,deadline:I(l.deadline).format("YYYY-MM-DD"),operationSource:"h5",detail:f,keyBase:A,ivBase:k}}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),i(),m&&m()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},D=(l,m,f)=>{s({type:"UPDATE",payload:{loading:!0}});const{text:A,keyBase:k,ivBase:le}=R(l.detail);t({url:`/todos/${m.id}`,method:"PATCH",data:{name:l.name,detail:A,keyBase:k,ivBase:le,deadline:I(l.deadline).format("YYYY-MM-DD"),tagId:l.tagId}}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),i(),f&&f()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},y=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/todos/${l.id}`,method:"PATCH",data:{isFinish:!0}}).then(()=>{i()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},E=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/todos/${l.id}`,method:"DELETE",data:{isFinish:!0}}).then(()=>{i()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},te=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/todos/${l.id}`,method:"PATCH",data:{isFinish:!1}}).then(()=>{i()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},ae=()=>{localStorage.setItem("token",""),r("/ndzy-todos/"),window.location.reload()},se=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/users/login",method:"POST",data:l}).then(m=>{s({type:"UPDATE",payload:{loading:!1}}),m&&m.data&&m.data.token&&(localStorage.setItem("token",m.data.token),r("/ndzy-todos/"),window.location.reload())}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},re=(l,m)=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/users/register",method:"POST",data:l}).then(f=>{s({type:"UPDATE",payload:{loading:!1}}),f.status===0&&m&&m()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},ne=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/tags/${l}`,method:"DELETE"}).then(()=>{u()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},oe=()=>{o&&(s({type:"UPDATE",payload:{loading:!0}}),t({url:"/tags",method:"POST",data:{name:o}}).then(()=>{n(""),u()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})}))},U=()=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/records",method:"GET"}).then(l=>{s({type:"UPDATE",payload:{records:l.data.map(m=>({...m,txt:V(m.txt,m.keyBase,m.ivBase)})),loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})};return{inputValue:o,initUser:c,initTags:u,createTodo:h,editTodo:D,goPage:r,getAllTodo:i,finishTodo:y,delTodo:E,recoverTodo:te,signOut:ae,login:se,register:re,delTag:ne,handleCreateTag:oe,setInputValue:n,switchService:()=>{localStorage.getItem("USE_LOCAL_SERVICE")==="0"?localStorage.setItem("USE_LOCAL_SERVICE","1"):localStorage.setItem("USE_LOCAL_SERVICE","0"),window.location.reload()},getAllRecord:U,addRecord:l=>{s({type:"UPDATE",payload:{loading:!0}});const{text:m,keyBase:f,ivBase:A}=R(l.txt);t({url:"/records",method:"POST",data:{...l,txt:m,keyBase:f,ivBase:A}}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),U()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},updateRecord:(l,m)=>{s({type:"UPDATE",payload:{loading:!0}});const{text:f,keyBase:A,ivBase:k}=R(m.txt);t({url:`/records/${l}`,method:"PATCH",data:{name:m.name,txt:f,keyBase:A,ivBase:k,txtInfo:m.txtInfo}}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),U()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},delRecord:l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/records/${l}`,method:"DELETE"}).then(()=>{U()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})}}},ze=()=>{const t=p.useRef(null),a=p.useRef(null),{inputValue:s,delTag:o,handleCreateTag:n,setInputValue:r}=S(),{state:c}=p.useContext(b),[u]=Se(c.tags,{containerTarget:t,wrapperTarget:a,itemHeight:60,overscan:10});return e.jsxs("div",{children:[e.jsxs(C.Compact,{className:"w-100",children:[e.jsx(T,{placeholder:"请输入",value:s,onChange:i=>r(i.target.value)}),e.jsx(x,{loading:c.loading,type:"primary",onClick:n,children:"添加"})]}),e.jsx("div",{ref:t,style:{height:window.innerHeight/2,overflow:"auto",marginTop:16},children:e.jsx("div",{ref:a,children:u.map(i=>{var h;return e.jsx("div",{style:{height:52,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100",children:[e.jsxs("div",{className:"between",children:[i.data.name,((h=c.user)==null?void 0:h.role)==="0"&&e.jsx(L,{title:"删除将无法恢复,确定删除?",onConfirm:()=>o(i.data.id),children:e.jsx(x,{children:" 删除"})})]}),e.jsx("div",{children:e.jsx(C,{children:e.jsxs("span",{children:["创建人：",i.data.userName||"--"]})})})]})},i.data.id)})})})]})},Ve=({children:t,...a})=>p.isValidElement(t)?p.cloneElement(t,{...a}):t,P=({title:t,btnName:a,children:s,...o})=>{const[n,r]=Ae({open:!1});return e.jsxs(e.Fragment,{children:[e.jsx(x,{type:"link",onClick:()=>r({open:!0}),children:a}),e.jsx(he,{destroyOnClose:!0,open:n.open,title:t,placement:"right",width:"100%",onClose:()=>r({open:!1}),children:e.jsx(Ve,{onClose:()=>r({open:!1}),...o,children:n&&s})})]})},$e=()=>{const{login:t}=S(),{state:a}=p.useContext(b);return e.jsxs(d,{...M,name:"login",onFinish:t,scrollToFirstError:!0,children:[e.jsx(d.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(T,{className:"w-100"})}),e.jsx(d.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(T.Password,{})}),e.jsx(d.Item,{...ee,children:e.jsx(x,{loading:a.loading,type:"primary",htmlType:"submit",children:"登录"})})]})},qe=({onClose:t})=>{const{register:a}=S(),{state:s}=p.useContext(b);return e.jsxs(d,{...M,name:"register",onFinish:o=>a(o,t),scrollToFirstError:!0,children:[e.jsx(d.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入你的昵称!",whitespace:!0}],children:e.jsx(T,{})}),e.jsx(d.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(T,{className:"w-100"})}),e.jsx(d.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(T.Password,{})}),e.jsx(d.Item,{name:"confirm",label:"确认密码",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"请再次输入密码!"},({getFieldValue:o})=>({validator(n,r){return!r||o("password")===r?Promise.resolve():Promise.reject(new Error("两次密码不匹配!"))}})],children:e.jsx(T.Password,{})}),e.jsx(d.Item,{...ee,children:e.jsx(x,{loading:s.loading,type:"primary",htmlType:"submit",children:"注册"})})]})},{Header:Ge,Content:Ke}=G,We=()=>{const{signOut:t,switchService:a,goPage:s}=S(),{state:o}=p.useContext(b),n=[{key:"0",label:e.jsx(P,{title:"登陆",btnName:"登陆",children:e.jsx($e,{})})},{key:"1",label:e.jsx(P,{title:"注册",btnName:"注册",children:e.jsx(qe,{})})},{key:"2",label:e.jsx(x,{type:"link",onClick:t,children:"登出"})},{key:"3",label:e.jsx(x,{type:"link",onClick:a,children:localStorage.getItem("USE_LOCAL_SERVICE")==="0"?"本地环境":"线上环境"})}];return e.jsxs(G,{className:"ndzy-layout",children:[e.jsx(Ge,{className:"ndzy-header",children:e.jsxs(C,{className:"mb-16",children:[o.user?e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:o.user.name||o.user.nickname}):e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:"游客"}),e.jsx(x,{type:"link",onClick:()=>s("/ndzy-todos"),children:"home"}),e.jsx(P,{title:"标签",btnName:"标签",children:e.jsx(ze,{})}),e.jsx(x,{type:"link",onClick:()=>s("/ndzy-todos/records"),children:"记录"}),e.jsx(ue,{menu:{items:n},children:e.jsx("a",{onClick:r=>r.preventDefault(),children:"其他"})})]})}),e.jsx(Ke,{children:e.jsx("div",{className:"layout-content p-16",children:e.jsx(Ie,{})})})]})},Je=({value:t})=>{const a=Q();return e.jsx("div",{style:{padding:"0 8px"},id:`preview-${a}`,className:"ndzy-preview",dangerouslySetInnerHTML:{__html:t}})},$=t=>e.jsxs(P,{title:"查看",btnName:"查看",children:[e.jsx(Je,{value:t.detail}),e.jsx("div",{children:e.jsxs(C,{children:[e.jsxs("span",{style:{color:"blue"},children:["创建人：",t.userName||"--"]}),e.jsxs("span",{style:{color:"green"},children:["标签：",t.tagName||"--"]}),e.jsxs("span",{style:{color:"red"},children:["终止日期：",I(t.deadline).format("YYYY-MM-DD")]})]})}),e.jsx("div",{children:e.jsxs(C,{children:[e.jsxs("span",{children:["创建日期：",I(t.createdAt).subtract(8,"h").format("YYYY-MM-DD")]}),e.jsxs("span",{children:["更新日期：",I(t.updatedAt).subtract(8,"h").format("YYYY-MM-DD")]})]})})]});ke.registerModule(Ue);function Xe({value:t,onChange:a}){const[s,o]=p.useState(null),[n,r]=p.useState("");p.useEffect(()=>{r(t)},[t]);const c={},u={placeholder:"请输入内容..."};return p.useEffect(()=>()=>{s!=null&&(s.destroy(),o(null))},[s]),e.jsx(e.Fragment,{children:e.jsxs("div",{style:{border:"1px solid #ccc",zIndex:100},children:[e.jsx(ve,{editor:s,defaultConfig:c,mode:"default",style:{borderBottom:"1px solid #ccc"}}),e.jsx(Re,{defaultConfig:u,value:n,onCreated:o,onChange:i=>{r(i.getHtml()),a(i.getHtml())},mode:"default",style:{overflowY:"hidden",minHeight:330}})]})})}const B=t=>{const{createTodo:a,editTodo:s}=S(),{state:o}=p.useContext(b),n=r=>t.id?s(r,{id:t.id},t.onClose):a(r,t.onClose);return e.jsxs(d,{initialValues:{name:t.name,deadline:t.deadline?I(t.deadline):I(),detail:t.detail,tagId:t.tagId},preserve:!1,name:"edit",onFinish:n,scrollToFirstError:!0,children:[e.jsx(d.Item,{name:"name",label:"名称",rules:[{required:!0,message:"名称不能为空"}],children:e.jsx(T.TextArea,{rows:1})}),e.jsx(d.Item,{name:"deadline",label:"终止时间",rules:[{required:!0,message:"终止时间不能为空"}],children:e.jsx(K,{className:"w-100",format:"YYYY-MM-DD",disabledDate:He})}),e.jsx(d.Item,{name:"detail",label:"详情",rules:[{required:!0,message:"详情不能为空"}],children:e.jsx(Xe,{})}),e.jsx(d.Item,{name:"tagId",label:"标签",rules:[{required:!0,message:"请选择一个标签"}],children:e.jsx(N,{options:o.tags.map(r=>({label:`${r.name}-(${r.userName})`,value:r.id}))})}),e.jsx(d.Item,{children:e.jsx(pe,{offsetBottom:16,children:e.jsx(x,{loading:o.loading,type:"primary",htmlType:"submit",children:t.id?"保存":"创建"})})})]})},{RangePicker:O}=K,Ze=()=>{const[t]=d.useForm(),a=p.useRef(null),s=J(a),{getAllTodo:o}=S(),{state:n}=p.useContext(b),r=Number(s==null?void 0:s.width)>800?8:24,[c,u]=p.useState(!1);return e.jsx("div",{ref:a,children:e.jsx(d,{form:t,...M,name:"search",onFinish:i=>{Object.keys(i).map(h=>{i[h]||delete i[h],(h==="createdRange"||h==="updatedRange"||h==="deadlineRange")&&i[h]&&(i[h]=JSON.stringify(i[h].map(D=>I(D).format("YYYY-MM-DD"))))}),o(i)},scrollToFirstError:!0,children:e.jsxs(xe,{gutter:24,children:[e.jsx(w,{span:r,children:e.jsx(d.Item,{name:"name",label:"名称",children:e.jsx(T,{className:"w-100",allowClear:!0})})}),c&&e.jsxs(e.Fragment,{children:[e.jsx(w,{span:r,children:e.jsx(d.Item,{name:"tagId",label:"标签",children:e.jsx(N,{allowClear:!0,className:"w-100",options:n.tags.map(i=>({label:`${i.name}-(${i.userName})`,value:i.id}))})})}),e.jsx(w,{span:r,children:e.jsx(d.Item,{name:"operationSource",label:"来源",children:e.jsx(N,{allowClear:!0,className:"w-100",options:[{label:"h5",value:"h5"},{label:"微信",value:"wx"}]})})}),e.jsx(w,{span:r,children:e.jsx(d.Item,{name:"isFinish",label:"状态",children:e.jsx(N,{allowClear:!0,className:"w-100",options:[{label:"处理中",value:"0"},{label:"已完成",value:"1"}]})})}),e.jsx(w,{span:r,children:e.jsx(d.Item,{name:"deadlineRange",label:"截止时间",children:e.jsx(O,{style:{width:"100%"}})})}),e.jsx(w,{span:r,children:e.jsx(d.Item,{name:"createdRange",label:"创建时间",children:e.jsx(O,{style:{width:"100%"}})})}),e.jsx(w,{span:r,children:e.jsx(d.Item,{name:"updatedRange",label:"更新时间",children:e.jsx(O,{style:{width:"100%"}})})})]}),e.jsx(w,{span:r,children:e.jsxs(C,{children:[e.jsx(x,{loading:n.loading,type:"primary",htmlType:"submit",children:"搜索"}),e.jsx(x,{type:"link",onClick:()=>{t.resetFields(),o()},children:"重置"}),e.jsxs("a",{style:{fontSize:12},onClick:()=>{u(!c)},children:[e.jsx(Ne,{rotate:c?180:0}),c?"收起":"展开"]}),e.jsx(P,{title:"新建",btnName:"新建",children:e.jsx(B,{})})]})})]})})})},Qe=()=>{const a=p.useRef(null),s=J(a),{state:o}=p.useContext(b),{initUser:n,initTags:r,getAllTodo:c,finishTodo:u,delTodo:i,recoverTodo:h}=S();Pe(()=>{n(),r(),c()});const D=[{title:"名称",dataIndex:"name",width:80},{title:"进度",dataIndex:"deadline",width:100,render:(y,E)=>{if(Number(E.isFinish)===0)return e.jsx("span",{style:{color:"red"},children:"处理中"});if(Number(E.isFinish)===1)return e.jsx("span",{style:{color:"green"},children:"已完成"})}},{title:"截止日期",dataIndex:"deadline",width:100},{title:"标签",dataIndex:"tagName",width:100},{title:"用户",dataIndex:"userName",width:100},{title:"创建时间",dataIndex:"createdAt",width:100},{title:"更新时间",dataIndex:"updatedAt",width:100},{title:"操作",width:120,fixed:"right",render:(y,E)=>e.jsxs(C,{children:[e.jsx($,{...E}),Number(E.isFinish)===0?e.jsxs(C,{children:[e.jsx(P,{title:"编辑",btnName:"编辑",...E,children:e.jsx(B,{})}),e.jsx(x,{type:"link",onClick:()=>u(E),children:"完成"})]}):Number(E.isFinish)===1?e.jsxs(C,{children:[e.jsx(x,{type:"link",onClick:()=>h(E),children:"恢复"}),e.jsx(L,{title:"删除将无法恢复,确定删除?",onConfirm:()=>i(E),children:e.jsx(x,{type:"link",children:" 删除"})})]}):null]})}];return e.jsxs("div",{ref:a,style:{height:"100%"},children:[o.loading&&e.jsx("div",{className:"center",children:e.jsx(ge,{})}),e.jsx(Ze,{}),Number(s==null?void 0:s.width)>800?e.jsx(W,{virtual:!0,columns:D,scroll:{x:900,y:600},rowKey:"id",dataSource:o.list,pagination:!1,locale:{emptyText:e.jsx("div",{className:"center",children:"暂无待办事项"})}}):e.jsx(F,{children:e.jsx(De,{data:o.list,height:600,itemHeight:40,itemKey:"email",children:y=>e.jsxs(F.Item,{actions:[e.jsx($,{...y}),...Number(y.isFinish)===0?[e.jsx(P,{title:"编辑",btnName:"编辑",...y,children:e.jsx(B,{})}),e.jsx(x,{type:"link",onClick:()=>u(y),children:"完成"})]:[e.jsx(x,{type:"link",onClick:()=>h(y),children:"恢复"}),e.jsx(L,{title:"删除将无法恢复,确定删除?",onConfirm:()=>i(y),children:e.jsx(x,{type:"link",children:" 删除"})})],...Number(y.isFinish)===0?[]:[]],children:[e.jsx(F.Item.Meta,{title:y.name,description:y.deadline}),e.jsx("div",{children:Number(y.isFinish)===0&&e.jsx("span",{style:{color:"red"},children:"处理中"})}),e.jsx("div",{children:Number(y.isFinish)===1&&e.jsx("span",{style:{color:"green"},children:"已完成"})})]},y.id)})})]})},et=()=>e.jsx("div",{className:"center",children:e.jsxs("div",{children:[e.jsx("h2",{children:"页面不存在"}),e.jsx("p",{children:e.jsx(ce,{to:"/ndzy-todos/",children:"返回首页"})})]})}),{Paragraph:q}=ye,tt=()=>{const[t]=d.useForm(),{getAllRecord:a,addRecord:s,delRecord:o}=S(),{state:n}=p.useContext(b);_(()=>{a()},[]),_(()=>{t.setFieldsValue({name:"",txt:"",txtInfo:""})},[n.records]);const r=u=>{u&&s(u)},c=[{title:"名称",dataIndex:"name",width:60,render:u=>e.jsx(q,{copyable:!0,children:u})},{title:"txt",dataIndex:"txt",width:120,render:u=>e.jsx(q,{copyable:!0,children:u})},{title:"描述",dataIndex:"txtInfo",width:20},{title:"操作",width:20,fixed:"right",render:(u,i)=>{var h;return((h=n.user)==null?void 0:h.role)==="0"&&e.jsx(L,{title:"删除将无法恢复,确定删除?",onConfirm:()=>o(i.id),children:e.jsx(Le,{})})}}];return e.jsxs("div",{children:[e.jsxs(d,{variant:"filled",style:{maxWidth:600},onFinish:r,form:t,children:[e.jsx(d.Item,{label:"name",name:"name",rules:[{required:!0,message:"不能为空"}],children:e.jsx(T,{placeholder:"请输入"})}),e.jsx(d.Item,{label:"txt",name:"txt",rules:[{required:!0,message:"不能为空"}],children:e.jsx(T,{placeholder:"请输入"})}),e.jsx(d.Item,{label:"txtInfo",name:"txtInfo",children:e.jsx(T,{placeholder:"请输入"})}),e.jsx(d.Item,{wrapperCol:{offset:6,span:16},children:e.jsx(x,{type:"primary",htmlType:"submit",loading:n.loading,children:"添加"})})]}),e.jsx(W,{virtual:!0,columns:c,scroll:{y:600},rowKey:"id",dataSource:n.records,pagination:!1,locale:{emptyText:e.jsx("div",{className:"center",children:"暂无待办事项"})}})]})},at=()=>{const[t,a]=p.useReducer(Fe,X);return e.jsx(je,{locale:fe,children:e.jsx(b.Provider,{value:{state:t,dispatch:a},children:e.jsx(we,{children:e.jsxs(v,{path:"/ndzy-todos/",element:e.jsx(We,{}),children:[e.jsx(v,{index:!0,element:e.jsx(Qe,{})}),e.jsx(v,{path:"/ndzy-todos/records",element:e.jsx(tt,{})}),e.jsx(v,{path:"*",element:e.jsx(et,{})})]})})})})};de.createRoot(document.getElementById("root")).render(e.jsx(ie.StrictMode,{children:e.jsx(me,{children:e.jsx(at,{})})}));
