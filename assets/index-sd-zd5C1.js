import{r as c,j as e,a as oe}from"./react-v0wmBK7J.js";import{c as ne}from"./react-dom-UBVWOR3A.js";import{L as le,B as ie}from"./react-router-dom-yYp181kb.js";import{s as x,F as m,I as b,D as de,S as P,A as ce,B as h,a as S,P as R,b as me,c as K,d as pe,e as ue,T as V,C as he,z as ge}from"./antd-RnRGtHTd.js";import{d as A}from"./dayjs-kWGic8Co.js";import{a as xe}from"./axios-G2rPRu76.js";import{C as f}from"./crypto-js-JGs7q0z2.js";import{a as ye,O as fe,d as je,e as Y}from"./react-router-wb6TWFZL.js";import{Z as Ae,m as Te,c as Se,u as De}from"./@wangeditor-LLZpb4f-.js";import{u as _,a as Ee,b as W}from"./ahooks-N2lLqjxU.js";import"./@babel-3ekFMeiY.js";import"./scheduler-iwWdm5Ml.js";import"./@remix-run-x3ZxUAMN.js";import"./@ant-design-RvwWwV4w.js";import"./rc-util-lDugnv_t.js";import"./react-is-q81m-9gd.js";import"./@emotion-folQEnri.js";import"./stylis-3miXmfPm.js";import"./classnames-TtJ58xUH.js";import"./resize-observer-polyfill-B32NGzNS.js";import"./@ctrl-_Y40OLZn.js";import"./rc-resize-observer-o3VbKI9v.js";import"./rc-motion-3OQy_Jtq.js";import"./rc-select-6rj0INnm.js";import"./rc-overflow-rzk4WcMz.js";import"./@rc-component-WrAyQiBq.js";import"./rc-virtual-list-ucRd-30s.js";import"./rc-picker-IlbCIjMl.js";import"./rc-menu-k1f7HuqC.js";import"./rc-input-sI1e-RV8.js";import"./rc-textarea-ZPFUzqHH.js";import"./rc-drawer-Ua4QVJzo.js";import"./rc-dropdown-DyWg6hut.js";import"./rc-field-form-EmJfX858.js";import"./async-validator-BHjhHa7C.js";import"./throttle-debounce-5p4B7Tol.js";import"./rc-notification-VD6ollsZ.js";import"./rc-tooltip-zrXB8Qye.js";import"./rc-pagination-7_Pl3KTq.js";import"./tslib-9i2l26Ba.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function s(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(r){if(r.ep)return;r.ep=!0;const l=s(r);fetch(r.href,l)}})();const Z={loading:!1,list:[],tags:[]},be=(t,a)=>{switch(a.type){case"UPDATE":return{...t,...a.payload||{}};default:return t}},D=c.createContext({state:Z,dispatch:()=>{}});x.config({top:100,duration:3,maxCount:1});if(!localStorage.getItem("DATA")){const t={todoList:[]};localStorage.setItem("DATA",JSON.stringify(t))}localStorage.getItem("USE_LOCAL_DATA")||localStorage.setItem("USE_LOCAL_DATA","0");localStorage.getItem("USE_LOCAL_SERVICE")||localStorage.setItem("USE_LOCAL_SERVICE","0");localStorage.getItem("BASE_URL")||localStorage.setItem("BASE_URL","http://localhost:3000");const q=localStorage.getItem("BASE_URL"),Ce=(localStorage.getItem("USE_LOCAL_SERVICE")||"0")==="0",Ie=Ce&&q?q:"https://ndzy-server.vercel.app",y=xe.create({baseURL:Ie,timeout:6e4,withCredentials:!1});y.interceptors.request.use(t=>{const a=localStorage.getItem("token");return a&&(t.headers={Authorization:"Basic "+a}),t},t=>{Promise.reject(t)});y.interceptors.response.use(t=>{const a=t.data;return t.data.status===1&&x.error(t.data.msg),t.data.status===0&&x.success(t.data.msg),t.data.status===2&&localStorage.setItem("token",""),a},t=>{let a="";if(t&&t.response)switch(t.response.status){case 302:a="接口重定向了！",x.error(a);break;case 400:a="参数不正确！",x.error(a);break;case 401:break;case 403:a="您没有权限操作！",x.error(a);break;case 404:a=`请求地址出错: ${t.response.config.url}`,x.error(a);break;case 408:a="请求超时！",x.error(a);break;case 409:a="系统已存在相同数据！",x.error(a);break;case 500:a="服务器内部错误！",x.error(a);break;case 501:a="服务未实现！",x.error(a);break;case 502:a="网关错误！",x.error(a);break;case 503:a="服务不可用！",x.error(a);break;case 504:a="服务暂时无法访问，请稍后再试！",x.error(a);break;case 505:a="HTTP 版本不受支持！",x.error(a);break;default:a="异常问题，请联系管理员！",x.error(a);break}return Promise.reject(a)});const Ue=t=>t&&t<A().endOf("day"),M=()=>{let t=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const o=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?o:o&3|8).toString(16)})},$=()=>{let t="";for(let a=0;a<8;a++)t+=M().replace(/-/g,"");return t},z=(t,a,s)=>{const o=f.enc.Utf8.parse(a),r=f.enc.Utf8.parse(s),l=f.enc.Hex.parse(t),i=f.enc.Base64.stringify(l);return f.AES.decrypt(i,o,{iv:r,mode:f.mode.CBC,padding:f.pad.Pkcs7,hasher:f.algo.SHA256}).toString(f.enc.Utf8).toString()},J=t=>{const a=$(),s=$(),o=f.enc.Utf8.parse(a),r=f.enc.Utf8.parse(s),l=f.enc.Utf8.parse(t),i=f.AES.encrypt(l,o,{iv:r,mode:f.mode.CBC,padding:f.pad.Pkcs7,hasher:f.algo.SHA256});return{keyBase:a,ivBase:s,text:i.ciphertext.toString().toUpperCase()}},B={labelCol:{xs:{span:6},sm:{span:6}},wrapperCol:{xs:{span:18},sm:{span:18}}},F={wrapperCol:{span:14,offset:2}},I=()=>{const t=(localStorage.getItem("USE_LOCAL_DATA")||"0")==="0",a=ye(),{dispatch:s}=c.useContext(D),[o,r]=c.useState(""),[l,i]=c.useState([]),g=(n,d={})=>{a(n,{...d})},u=()=>{s({type:"UPDATE",payload:{loading:!0}}),y.get("/users").then(n=>{s({type:"UPDATE",payload:{user:n.data,loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},C=()=>{s({type:"UPDATE",payload:{loading:!0}}),y("/tags").then(n=>{s({type:"UPDATE",payload:{tags:n.data,loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},T=(n={})=>{if(s({type:"UPDATE",payload:{loading:!0}}),t){const d=JSON.parse(localStorage.getItem("DATA"));s({type:"UPDATE",payload:{list:d.todoList.map(p=>({...p,detail:z(p.detail,p.keyBase,p.ivBase)})),loading:!1}})}else y.get("/todos",{params:{...n}}).then(d=>{s({type:"UPDATE",payload:{list:d.data.map(p=>({...p,detail:z(p.detail,p.keyBase,p.ivBase)})),loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},U=(n,d)=>{s({type:"UPDATE",payload:{loading:!0}});const{text:p,keyBase:k,ivBase:v}=J(n.detail);if(t){const w=JSON.parse(localStorage.getItem("DATA"));w.todoList.push({id:M(),...n,deadline:A(n.deadline).format("YYYY-MM-DD"),operationSource:"h5",detail:p,keyBase:k,ivBase:v,isLocal:!0}),localStorage.setItem("DATA",JSON.stringify(w)),s({type:"UPDATE",payload:{list:w.todoList,loading:!1}}),T(),d&&d()}else y.post("/todos",{...n,deadline:A(n.deadline).format("YYYY-MM-DD"),operationSource:"h5",detail:p,keyBase:k,ivBase:v}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),T(),d&&d()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},j=(n,d,p)=>{s({type:"UPDATE",payload:{loading:!0}});const{text:k,keyBase:v,ivBase:w}=J(n.detail);if(t){const L=JSON.parse(localStorage.getItem("DATA"));L.todoList=L.todoList.map(N=>N.id===d.id?{...N,name:n.name,detail:k,keyBase:v,ivBase:w,deadline:A(n.deadline).format("YYYY-MM-DD"),tagId:n.tagId}:N),localStorage.setItem("DATA",JSON.stringify(L)),s({type:"UPDATE",payload:{list:L.todoList,loading:!1}}),T(),p&&p()}else y.patch(`/todos/${d.id}`,{name:n.name,detail:k,keyBase:v,ivBase:w,deadline:A(n.deadline).format("YYYY-MM-DD"),tagId:n.tagId}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),T(),p&&p()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},G=n=>{s({type:"UPDATE",payload:{loading:!0}}),y.patch(`/todos/${n.id}`,{isFinish:!0}).then(()=>{T()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},Q=n=>{s({type:"UPDATE",payload:{loading:!0}}),y.delete(`/todos/${n.id}`).then(()=>{T()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},X=n=>{s({type:"UPDATE",payload:{loading:!0}}),y.patch(`/todos/${n.id}`,{isFinish:!1}).then(()=>{T()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},ee=()=>{localStorage.setItem("token",""),g("/ndzy-todos/"),window.location.reload()},te=n=>{s({type:"UPDATE",payload:{loading:!0}}),y.post("/users/login",{...n}).then(d=>{s({type:"UPDATE",payload:{loading:!1}}),d&&d.data&&d.data.token&&(localStorage.setItem("token",d.data.token),g("/ndzy-todos/"),window.location.reload())}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},ae=(n,d)=>{s({type:"UPDATE",payload:{loading:!0}}),y.post("/users/register",{...n}).then(p=>{s({type:"UPDATE",payload:{loading:!1}}),p.status===0&&d&&d()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},se=n=>{s({type:"UPDATE",payload:{loading:!0}}),y.delete(`/tags/${n}`).then(()=>{C()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},re=()=>{o&&(s({type:"UPDATE",payload:{loading:!0}}),y.post("/tags",{name:o}).then(()=>{r(""),C()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})}))},H=async()=>{s({type:"UPDATE",payload:{loading:!0}}),u(),y.get("/users/all").then(n=>{s({type:"UPDATE",payload:{loading:!1}}),i(n.data)}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})};return{inputValue:o,users:l,initUser:u,initTags:C,createTodo:U,editTodo:j,goPage:g,getAllTodo:T,finishTodo:G,delTodo:Q,recoverTodo:X,signOut:ee,login:te,register:ae,delTag:se,handleCreateTag:re,setInputValue:r,getUsers:H,delUser:n=>{s({type:"UPDATE",payload:{loading:!0}}),y.delete(`/users/${n.id}`).then(()=>{H()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},isLocal:t,switchData:()=>{localStorage.getItem("USE_LOCAL_DATA")==="0"?localStorage.setItem("USE_LOCAL_DATA","1"):localStorage.setItem("USE_LOCAL_DATA","0"),window.location.reload()},switchService:()=>{localStorage.getItem("USE_LOCAL_SERVICE")==="0"?localStorage.setItem("USE_LOCAL_SERVICE","1"):localStorage.setItem("USE_LOCAL_SERVICE","0"),window.location.reload()},delLocalData:n=>{const d=JSON.parse(localStorage.getItem("DATA"));d.todoList=d.todoList.filter(p=>p.id!==n),localStorage.setItem("DATA",JSON.stringify(d)),s({type:"UPDATE",payload:{list:d.todoList,loading:!1}}),T()}}};Ae.registerModule(Te);function we({value:t,onChange:a}){const[s,o]=c.useState(null),[r,l]=c.useState("");c.useEffect(()=>{l(t)},[t]);const i={},g={placeholder:"请输入内容..."};return c.useEffect(()=>()=>{s!=null&&(s.destroy(),o(null))},[s]),e.jsx(e.Fragment,{children:e.jsxs("div",{style:{border:"1px solid #ccc",zIndex:100},children:[e.jsx(Se,{editor:s,defaultConfig:i,mode:"default",style:{borderBottom:"1px solid #ccc"}}),e.jsx(De,{defaultConfig:g,value:r,onCreated:o,onChange:u=>{l(u.getHtml()),a(u.getHtml())},mode:"default",style:{overflowY:"hidden",minHeight:330}})]})})}const O=t=>{const{createTodo:a,editTodo:s,isLocal:o}=I(),{state:r}=c.useContext(D),l=i=>t.id?s(i,{id:t.id},t.onClose):a(i,t.onClose);return e.jsxs(m,{initialValues:{name:t.name,deadline:t.deadline?A(t.deadline):A(),detail:t.detail,tagId:t.tagId},preserve:!1,name:"edit",onFinish:l,scrollToFirstError:!0,children:[e.jsx(m.Item,{name:"name",label:"名称",rules:[{required:!0,message:"名称不能为空"}],children:e.jsx(b.TextArea,{rows:1})}),e.jsx(m.Item,{name:"deadline",label:"终止时间",rules:[{required:!0,message:"终止时间不能为空"}],children:e.jsx(de,{className:"w-100",format:"YYYY-MM-DD",disabledDate:Ue})}),e.jsx(m.Item,{name:"detail",label:"详情",rules:[{required:!0,message:"详情不能为空"}],children:e.jsx(we,{})}),e.jsx(m.Item,{name:"tagId",label:"标签",rules:[{required:!o,message:"请选择一个标签"}],children:e.jsx(P,{options:r.tags.map(i=>({label:`${i.name}-(${i.userName})`,value:i.id}))})}),e.jsx(m.Item,{children:e.jsx(ce,{offsetBottom:16,children:e.jsx(h,{loading:r.loading,type:"primary",htmlType:"submit",children:t.id?"保存":"创建"})})})]})},ke=()=>{const t=c.useRef(null),a=c.useRef(null),{inputValue:s,delTag:o,handleCreateTag:r,setInputValue:l}=I(),{state:i}=c.useContext(D),[g]=_(i.tags,{containerTarget:t,wrapperTarget:a,itemHeight:60,overscan:10});return e.jsxs("div",{children:[e.jsxs(S.Compact,{className:"w-100",children:[e.jsx(b,{placeholder:"请输入",value:s,onChange:u=>l(u.target.value)}),e.jsx(h,{loading:i.loading,type:"primary",onClick:r,children:"添加"})]}),e.jsx("div",{ref:t,style:{height:window.innerHeight/2,overflow:"auto",marginTop:16},children:e.jsx("div",{ref:a,children:g.map(u=>{var C;return e.jsx("div",{style:{height:52,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100",children:[e.jsxs("div",{className:"between",children:[u.data.name,((C=i.user)==null?void 0:C.role)==="0"&&e.jsx(R,{title:"删除将无法恢复,确定删除?",onConfirm:()=>o(u.data.id),children:e.jsx(h,{children:" 删除"})})]}),e.jsx("div",{children:e.jsx(S,{children:e.jsxs("span",{children:["创建人：",u.data.userName||"--"]})})})]})},u.data.id)})})})]})},ve=({children:t,...a})=>c.isValidElement(t)?c.cloneElement(t,{...a}):t,E=({title:t,btnName:a,children:s,...o})=>{const[r,l]=Ee({open:!1});return e.jsxs(e.Fragment,{children:[e.jsx(h,{type:"link",onClick:()=>l({open:!0}),children:a}),e.jsx(me,{destroyOnClose:!0,open:r.open,title:t,placement:"right",width:"100%",onClose:()=>l({open:!1}),children:e.jsx(ve,{onClose:()=>l({open:!1}),...o,children:r&&s})})]})},Le=()=>{const{login:t}=I(),{state:a}=c.useContext(D);return e.jsxs(m,{...B,name:"login",onFinish:t,scrollToFirstError:!0,children:[e.jsx(m.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(b,{className:"w-100"})}),e.jsx(m.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(b.Password,{})}),e.jsx(m.Item,{...F,children:e.jsx(h,{loading:a.loading,type:"primary",htmlType:"submit",children:"登录"})})]})},Pe=({onClose:t})=>{const{register:a}=I(),{state:s}=c.useContext(D);return e.jsxs(m,{...B,name:"register",onFinish:o=>a(o,t),scrollToFirstError:!0,children:[e.jsx(m.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入你的昵称!",whitespace:!0}],children:e.jsx(b,{})}),e.jsx(m.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(b,{className:"w-100"})}),e.jsx(m.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(b.Password,{})}),e.jsx(m.Item,{name:"confirm",label:"确认密码",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"请再次输入密码!"},({getFieldValue:o})=>({validator(r,l){return!l||o("password")===l?Promise.resolve():Promise.reject(new Error("两次密码不匹配!"))}})],children:e.jsx(b.Password,{})}),e.jsx(m.Item,{...F,children:e.jsx(h,{loading:s.loading,type:"primary",htmlType:"submit",children:"注册"})})]})},Ne=()=>{const t=c.useRef(null),a=c.useRef(null),{users:s,delUser:o,getUsers:r}=I(),{state:l}=c.useContext(D),[i]=_(s,{containerTarget:t,wrapperTarget:a,itemHeight:60,overscan:10});return W(()=>{r()}),e.jsx("div",{ref:t,style:{height:window.innerHeight/2,overflow:"auto"},children:e.jsx("div",{ref:a,children:i.map(g=>{var u;return e.jsx("div",{style:{height:52,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100",children:[e.jsxs("div",{className:"between",children:["用户名：",g.data.nickname,((u=l.user)==null?void 0:u.role)==="0"&&e.jsx(R,{title:"删除将无法恢复,确定删除?",onConfirm:()=>o(g.data),children:e.jsx(h,{children:" 删除"})})]}),e.jsx("div",{children:e.jsxs(S,{children:[e.jsxs("span",{children:["创建日期：",A(g.data.createdAt).subtract(8,"h").format("YYYY-MM-DD")]}),e.jsxs("span",{children:["更新日期：",A(g.data.updatedAt).subtract(8,"h").format("YYYY-MM-DD")]})]})})]})},g.data.id)})})})},Ye=({onClose:t})=>{const{getAllTodo:a}=I(),{state:s}=c.useContext(D);return e.jsxs(m,{initialValues:{operationSource:"h5",isFinish:"0"},...B,name:"search",onFinish:o=>{a(o),t()},scrollToFirstError:!0,children:[e.jsx(m.Item,{name:"name",label:"名称",children:e.jsx(b,{className:"w-100"})}),e.jsx(m.Item,{name:"tagId",label:"标签",children:e.jsx(P,{className:"w-100",options:s.tags.map(o=>({label:`${o.name}-(${o.userName})`,value:o.id}))})}),e.jsx(m.Item,{name:"operationSource",label:"来源",children:e.jsx(P,{className:"w-100",options:[{label:"h5",value:"h5"},{label:"微信",value:"wx"}]})}),e.jsx(m.Item,{name:"isFinish",label:"状态",children:e.jsx(P,{className:"w-100",options:[{label:"进行中",value:"0"},{label:"已完成",value:"1"}]})}),e.jsx(m.Item,{...F,children:e.jsx(h,{loading:s.loading,type:"primary",htmlType:"submit",children:"搜索"})})]})},{Header:Oe,Content:Re}=K,_e=()=>{const{signOut:t,getAllTodo:a,switchData:s,switchService:o}=I(),{state:r}=c.useContext(D),l=[{key:"0",label:e.jsx(E,{title:"标签",btnName:"标签",children:e.jsx(ke,{})})},{key:"1",label:e.jsx(E,{title:"登陆",btnName:"登陆",children:e.jsx(Le,{})})},{key:"2",label:e.jsx(E,{title:"注册",btnName:"注册",children:e.jsx(Pe,{})})},{key:"3",label:r.user&&r.user.role==="0"&&e.jsx(E,{title:"用户管理",btnName:"用户管理",children:e.jsx(Ne,{})})},{key:"4",label:e.jsx(h,{type:"link",onClick:t,children:"登出"})},{key:"5",label:e.jsx(h,{type:"link",onClick:o,children:localStorage.getItem("USE_LOCAL_SERVICE")==="0"?"本地环境":"线上环境"})},{key:"6",label:e.jsx(h,{type:"link",onClick:s,children:localStorage.getItem("USE_LOCAL_DATA")==="0"?"本地数据":"接口数据"})}];return e.jsxs(K,{className:"ndzy-layout",children:[e.jsx(Oe,{className:"ndzy-header",children:e.jsxs(S,{className:"mb-16",children:[r.user?e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:r.user.name||r.user.nickname}):e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:"游客"}),e.jsx(E,{title:"新建",btnName:"新建",children:e.jsx(O,{})}),e.jsx(E,{title:"搜索",btnName:"搜索",children:e.jsx(Ye,{})}),e.jsx(h,{type:"link",onClick:()=>a(),children:"重置"}),e.jsx(pe,{menu:{items:l},children:e.jsx("a",{onClick:i=>i.preventDefault(),children:"其他"})})]})}),e.jsx(Re,{children:e.jsx("div",{className:"layout-content p-16",children:e.jsx(fe,{})})})]})},Me=({value:t})=>{const a=M();return e.jsx("div",{style:{padding:"0 8px"},id:`preview-${a}`,className:"ndzy-preview",dangerouslySetInnerHTML:{__html:t}})},Be=t=>e.jsxs(E,{title:"查看",btnName:"查看",children:[e.jsx(Me,{value:t.detail}),e.jsx("div",{children:e.jsxs(S,{children:[e.jsxs("span",{style:{color:"blue"},children:["创建人：",t.userName||"--"]}),e.jsxs("span",{style:{color:"green"},children:["标签：",t.tagName||"--"]}),e.jsxs("span",{style:{color:"red"},children:["终止日期：",A(t.deadline).format("YYYY-MM-DD")]})]})}),e.jsx("div",{children:e.jsxs(S,{children:[e.jsxs("span",{children:["创建日期：",A(t.createdAt).subtract(8,"h").format("YYYY-MM-DD")]}),e.jsxs("span",{children:["更新日期：",A(t.updatedAt).subtract(8,"h").format("YYYY-MM-DD")]})]})})]}),Fe=()=>{const{state:t}=c.useContext(D),a=c.useRef(null),s=c.useRef(null),[o]=_(t.list,{containerTarget:a,wrapperTarget:s,itemHeight:60,overscan:10}),{initUser:r,initTags:l,getAllTodo:i,finishTodo:g,delTodo:u,recoverTodo:C,delLocalData:T,isLocal:U}=I();return W(()=>{r(),l(),i()}),e.jsxs("div",{children:[e.jsx("div",{className:"center",children:t.loading&&e.jsx(ue,{})}),o.length===0&&e.jsx("div",{className:"center",children:"暂无待办事项"}),e.jsx("div",{ref:a,style:{height:window.innerHeight*.88,overflow:"auto"},children:e.jsx("div",{ref:s,children:o.map(j=>e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100 todo-item",children:[e.jsx("div",{children:e.jsxs(S,{children:[j.data.name,e.jsx(V,{color:"pink",children:j.data.deadline}),!U&&e.jsx(V,{color:"green",children:j.data.tagName})]})}),e.jsx("div",{children:e.jsxs(S,{children:[e.jsx(Be,{...j.data}),U&&e.jsx(E,{title:"编辑",btnName:"编辑",...j.data,children:e.jsx(O,{})}),U&&e.jsx(h,{type:"link",onClick:()=>T(j.data.id),children:"删除"}),U&&e.jsx(h,{type:"link",onClick:()=>{},children:"同步"}),Number(j.data.isFinish)===0?e.jsxs(S,{children:[e.jsx("span",{style:{color:"red"},children:"处理中"}),e.jsx(E,{title:"编辑",btnName:"编辑",...j.data,children:e.jsx(O,{})}),e.jsx(h,{type:"link",onClick:()=>g(j.data),children:"完成"})]}):Number(j.data.isFinish)===1?e.jsxs(S,{children:[e.jsx("span",{style:{color:"green"},children:"已完成"}),e.jsx(h,{type:"link",onClick:()=>C(j.data),children:"恢复"}),e.jsx(R,{title:"删除将无法恢复,确定删除?",onConfirm:()=>u(j.data),children:e.jsx(h,{type:"link",children:" 删除"})})]}):null]})})]})},j.data.id))})})]})},He=()=>e.jsx("div",{className:"center",children:e.jsxs("div",{children:[e.jsx("h2",{children:"页面不存在"}),e.jsx("p",{children:e.jsx(le,{to:"/",children:"返回首页"})})]})}),Ve=()=>{const[t,a]=c.useReducer(be,Z);return e.jsx(he,{locale:ge,children:e.jsx(D.Provider,{value:{state:t,dispatch:a},children:e.jsx(je,{children:e.jsxs(Y,{path:"/ndzy-todos/",element:e.jsx(_e,{}),children:[e.jsx(Y,{index:!0,element:e.jsx(Fe,{})}),e.jsx(Y,{path:"*",element:e.jsx(He,{})})]})})})})};ne.createRoot(document.getElementById("root")).render(e.jsx(oe.StrictMode,{children:e.jsx(ie,{children:e.jsx(Ve,{})})}));
