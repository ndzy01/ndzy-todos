import{r as p,j as e,a as ie}from"./react-Tf5a63N3.js";import{c as de}from"./react-dom-L-9RVvDo.js";import{L as ce,B as me}from"./react-router-dom-XpqpMlL4.js";import{s as x,F as i,I as j,D as ue,S as v,A as pe,B as g,a as b,P as k,b as he,c as H,d as xe,e as ge,T as V,f as ye,C as fe,z as je}from"./antd-qG9QhWnG.js";import{d as T}from"./dayjs-I44_pL56.js";import{a as Ee}from"./axios-G2rPRu76.js";import{c as Te}from"./@wxcloud-VArnRXkh.js";import{C as y}from"./crypto-js-cnNLbfBj.js";import{a as be,O as Ae,d as Ce,e as D}from"./react-router-HlPHIle8.js";import{Z as Ie,m as we,c as Pe,u as Se}from"./@wangeditor-gzx6jVfq.js";import{u as z,a as De,b as q,c as B}from"./ahooks-H1r1rAbr.js";import{O as Ue}from"./@ant-design-oGzNwhgm.js";import"./@babel-fXcOJB-X.js";import"./scheduler-iwWdm5Ml.js";import"./@remix-run-1q7uUoWE.js";import"./rc-util-44hGjeVP.js";import"./react-is-q81m-9gd.js";import"./classnames-RRvKwVVO.js";import"./rc-resize-observer-ck5JqIRG.js";import"./resize-observer-polyfill-B32NGzNS.js";import"./rc-motion-7vv53bTg.js";import"./rc-picker-xixrHE6j.js";import"./@rc-component-oibO48Qt.js";import"./rc-menu-Q3iJPZGu.js";import"./rc-overflow-VxRkfzAh.js";import"./rc-select-WtCpbyab.js";import"./rc-virtual-list-BXD3VVHE.js";import"./@ctrl-_Y40OLZn.js";import"./rc-drawer-fZgySpmT.js";import"./rc-field-form-Rdl82lVd.js";import"./async-validator-BHjhHa7C.js";import"./rc-notification-7I1nwpoC.js";import"./rc-tooltip-dc6ms-Ot.js";import"./rc-table-PhNwxsIQ.js";import"./rc-tree-xZ6JQgv9.js";import"./rc-checkbox-bfzdVFQB.js";import"./rc-dropdown-QKhfUTW0.js";import"./rc-pagination-6SoAqjZS.js";import"./throttle-debounce-5p4B7Tol.js";import"./copy-to-clipboard-ds7YnVhZ.js";import"./toggle-selection-fekekO1r.js";import"./rc-textarea-Ly7unUNs.js";import"./rc-input-zn8sb5C_.js";import"./lodash-o2jpNBUl.js";import"./tslib-9i2l26Ba.js";import"./@emotion-folQEnri.js";import"./stylis-3miXmfPm.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function s(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=s(r);fetch(r.href,o)}})();const $={loading:!1,list:[],tags:[],records:[]},ve=(t,a)=>{switch(a.type){case"UPDATE":return{...t,...a.payload||{}};default:return t}},E=p.createContext({state:$,dispatch:()=>{}});x.config({top:100,duration:3,maxCount:1});localStorage.getItem("USE_LOCAL_SERVICE")||localStorage.setItem("USE_LOCAL_SERVICE","1");localStorage.getItem("BASE_URL")||localStorage.setItem("BASE_URL","http://localhost:3000");const F=localStorage.getItem("BASE_URL"),ke=(localStorage.getItem("USE_LOCAL_SERVICE")||"0")==="0",Ne=ke&&F?F:"https://ndzy-server.vercel.app",N=Ee.create({baseURL:Ne,timeout:6e4,withCredentials:!1});N.interceptors.request.use(t=>{const a=localStorage.getItem("token");return a&&(t.headers={Authorization:"Basic "+a}),t},t=>{Promise.reject(t)});N.interceptors.response.use(t=>{const a=t.data;return t.data.status===1&&x.error(t.data.msg),t.data.status===0&&x.success(t.data.msg),t.data.status===2&&localStorage.setItem("token",""),a},t=>{let a="";if(t&&t.response)switch(t.response.status){case 302:a="接口重定向了！",x.error(a);break;case 400:a="参数不正确！",x.error(a);break;case 401:break;case 403:a="您没有权限操作！",x.error(a);break;case 404:a=`请求地址出错: ${t.response.config.url}`,x.error(a);break;case 408:a="请求超时！",x.error(a);break;case 409:a="系统已存在相同数据！",x.error(a);break;case 500:a="服务器内部错误！",x.error(a);break;case 501:a="服务未实现！",x.error(a);break;case 502:a="网关错误！",x.error(a);break;case 503:a="服务不可用！",x.error(a);break;case 504:a="服务暂时无法访问，请稍后再试！",x.error(a);break;case 505:a="HTTP 版本不受支持！",x.error(a);break;default:a="异常问题，请联系管理员！",x.error(a);break}return Promise.reject(a)});const Re=Te.initCloud(),G=Re.Cloud({identityless:!0,resourceAppid:"wxf18966ace3bbbd97",resourceEnv:"prod-3gjeiq7x1fbed11e"});G.init();const Le=t=>{const{url:a="",data:s={}}=t,n=a,r=localStorage.getItem("token"),o={"X-WX-SERVICE":"ndzy-service"};return r&&(o.Authorization="Basic "+r),new Promise((u,m)=>{G.callContainer({...t,config:{env:"prod-3gjeiq7x1fbed11e"},path:n,header:o,method:t.method,data:s}).then(d=>{d.data.status===1&&x.error(d.data.msg),d.data.status===0&&x.success(d.data.msg),d.data.status===2&&localStorage.setItem("token",""),u(d.data)}).catch(()=>{m("网络错误")})})},Ye=t=>t&&t<T().endOf("day"),K=()=>{let t=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,s=>{const n=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(s=="x"?n:n&3|8).toString(16)})},M=()=>{let t="";for(let a=0;a<8;a++)t+=K().replace(/-/g,"");return t},O=(t,a,s)=>{const n=y.enc.Utf8.parse(a),r=y.enc.Utf8.parse(s),o=y.enc.Hex.parse(t),u=y.enc.Base64.stringify(o);return y.AES.decrypt(u,n,{iv:r,mode:y.mode.CBC,padding:y.pad.Pkcs7,hasher:y.algo.SHA256}).toString(y.enc.Utf8).toString()},U=t=>{const a=M(),s=M(),n=y.enc.Utf8.parse(a),r=y.enc.Utf8.parse(s),o=y.enc.Utf8.parse(t),u=y.AES.encrypt(o,n,{iv:r,mode:y.mode.CBC,padding:y.pad.Pkcs7,hasher:y.algo.SHA256});return{keyBase:a,ivBase:s,text:u.ciphertext.toString().toUpperCase()}},R={labelCol:{xs:{span:6},sm:{span:6}},wrapperCol:{xs:{span:18},sm:{span:18}}},L={wrapperCol:{span:14,offset:2}},A=()=>{const t=(localStorage.getItem("USE_LOCAL_SERVICE")||"0")==="0"?N:Le,a=be(),{dispatch:s}=p.useContext(E),[n,r]=p.useState(""),[o,u]=p.useState([]),m=(l,c={})=>{a(l,{...c})},d=()=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/users/loginInfo",method:"GET"}).then(l=>{s({type:"UPDATE",payload:{user:l.data[0],loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},h=()=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/tags",method:"GET"}).then(l=>{s({type:"UPDATE",payload:{tags:l.data,loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},w=(l={})=>{console.log("ndzy---log---ndzy",l,"------"),s({type:"UPDATE",payload:{loading:!0}}),t({url:"/todos",method:"GET"}).then(c=>{s({type:"UPDATE",payload:{list:c.data.map(f=>({...f,detail:O(f.detail,f.keyBase,f.ivBase)})),loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},X=(l,c)=>{s({type:"UPDATE",payload:{loading:!0}});const{text:f,keyBase:I,ivBase:P}=U(l.detail);t({url:"/todos",method:"POST",data:{...l,deadline:T(l.deadline).format("YYYY-MM-DD"),operationSource:"h5",detail:f,keyBase:I,ivBase:P}}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),w(),c&&c()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},Z=(l,c,f)=>{s({type:"UPDATE",payload:{loading:!0}});const{text:I,keyBase:P,ivBase:le}=U(l.detail);t({url:`/todos/${c.id}`,method:"PATCH",data:{name:l.name,detail:I,keyBase:P,ivBase:le,deadline:T(l.deadline).format("YYYY-MM-DD"),tagId:l.tagId}}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),w(),f&&f()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},J=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/todos/${l.id}`,method:"PATCH",data:{isFinish:!0}}).then(()=>{w()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},Q=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/todos/${l.id}`,method:"DELETE",data:{isFinish:!0}}).then(()=>{w()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},ee=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/todos/${l.id}`,method:"PATCH",data:{isFinish:!1}}).then(()=>{w()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},te=()=>{localStorage.setItem("token",""),m("/ndzy-todos/"),window.location.reload()},ae=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/users/login",method:"POST",data:l}).then(c=>{s({type:"UPDATE",payload:{loading:!1}}),c&&c.data&&c.data.token&&(localStorage.setItem("token",c.data.token),m("/ndzy-todos/"),window.location.reload())}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},se=(l,c)=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/users/register",method:"POST",data:l}).then(f=>{s({type:"UPDATE",payload:{loading:!1}}),f.status===0&&c&&c()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},re=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/tags/${l}`,method:"DELETE"}).then(()=>{h()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},oe=()=>{n&&(s({type:"UPDATE",payload:{loading:!0}}),t({url:"/tags",method:"POST",data:{name:n}}).then(()=>{r(""),h()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})}))},Y=async()=>{s({type:"UPDATE",payload:{loading:!0}}),d(),t({url:"/users",method:"GET"}).then(l=>{s({type:"UPDATE",payload:{loading:!1}}),u(l.data)}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},ne=l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/users/${l.id}`,method:"DELETE"}).then(()=>{Y()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},S=()=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:"/records",method:"GET"}).then(l=>{s({type:"UPDATE",payload:{records:l.data.map(c=>({...c,txt:O(c.txt,c.keyBase,c.ivBase)})),loading:!1}})}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})};return{inputValue:n,users:o,initUser:d,initTags:h,createTodo:X,editTodo:Z,goPage:m,getAllTodo:w,finishTodo:J,delTodo:Q,recoverTodo:ee,signOut:te,login:ae,register:se,delTag:re,handleCreateTag:oe,setInputValue:r,getUsers:Y,delUser:ne,switchService:()=>{localStorage.getItem("USE_LOCAL_SERVICE")==="0"?localStorage.setItem("USE_LOCAL_SERVICE","1"):localStorage.setItem("USE_LOCAL_SERVICE","0"),window.location.reload()},getAllRecord:S,addRecord:l=>{s({type:"UPDATE",payload:{loading:!0}});const{text:c,keyBase:f,ivBase:I}=U(l.txt);t({url:"/records",method:"POST",data:{...l,txt:c,keyBase:f,ivBase:I}}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),S()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},updateRecord:(l,c)=>{s({type:"UPDATE",payload:{loading:!0}});const{text:f,keyBase:I,ivBase:P}=U(c.txt);t({url:`/records/${l}`,method:"PATCH",data:{name:c.name,txt:f,keyBase:I,ivBase:P,txtInfo:c.txtInfo}}).then(()=>{s({type:"UPDATE",payload:{loading:!1}}),S()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})},delRecord:l=>{s({type:"UPDATE",payload:{loading:!0}}),t({url:`/records/${l}`,method:"DELETE"}).then(()=>{S()}).catch(()=>{s({type:"UPDATE",payload:{loading:!1}})})}}};Ie.registerModule(we);function Be({value:t,onChange:a}){const[s,n]=p.useState(null),[r,o]=p.useState("");p.useEffect(()=>{o(t)},[t]);const u={},m={placeholder:"请输入内容..."};return p.useEffect(()=>()=>{s!=null&&(s.destroy(),n(null))},[s]),e.jsx(e.Fragment,{children:e.jsxs("div",{style:{border:"1px solid #ccc",zIndex:100},children:[e.jsx(Pe,{editor:s,defaultConfig:u,mode:"default",style:{borderBottom:"1px solid #ccc"}}),e.jsx(Se,{defaultConfig:m,value:r,onCreated:n,onChange:d=>{o(d.getHtml()),a(d.getHtml())},mode:"default",style:{overflowY:"hidden",minHeight:330}})]})})}const W=t=>{const{createTodo:a,editTodo:s}=A(),{state:n}=p.useContext(E),r=o=>t.id?s(o,{id:t.id},t.onClose):a(o,t.onClose);return e.jsxs(i,{initialValues:{name:t.name,deadline:t.deadline?T(t.deadline):T(),detail:t.detail,tagId:t.tagId},preserve:!1,name:"edit",onFinish:r,scrollToFirstError:!0,children:[e.jsx(i.Item,{name:"name",label:"名称",rules:[{required:!0,message:"名称不能为空"}],children:e.jsx(j.TextArea,{rows:1})}),e.jsx(i.Item,{name:"deadline",label:"终止时间",rules:[{required:!0,message:"终止时间不能为空"}],children:e.jsx(ue,{className:"w-100",format:"YYYY-MM-DD",disabledDate:Ye})}),e.jsx(i.Item,{name:"detail",label:"详情",rules:[{required:!0,message:"详情不能为空"}],children:e.jsx(Be,{})}),e.jsx(i.Item,{name:"tagId",label:"标签",rules:[{required:!0,message:"请选择一个标签"}],children:e.jsx(v,{options:n.tags.map(o=>({label:`${o.name}-(${o.userName})`,value:o.id}))})}),e.jsx(i.Item,{children:e.jsx(pe,{offsetBottom:16,children:e.jsx(g,{loading:n.loading,type:"primary",htmlType:"submit",children:t.id?"保存":"创建"})})})]})},Fe=()=>{const t=p.useRef(null),a=p.useRef(null),{inputValue:s,delTag:n,handleCreateTag:r,setInputValue:o}=A(),{state:u}=p.useContext(E),[m]=z(u.tags,{containerTarget:t,wrapperTarget:a,itemHeight:60,overscan:10});return e.jsxs("div",{children:[e.jsxs(b.Compact,{className:"w-100",children:[e.jsx(j,{placeholder:"请输入",value:s,onChange:d=>o(d.target.value)}),e.jsx(g,{loading:u.loading,type:"primary",onClick:r,children:"添加"})]}),e.jsx("div",{ref:t,style:{height:window.innerHeight/2,overflow:"auto",marginTop:16},children:e.jsx("div",{ref:a,children:m.map(d=>{var h;return e.jsx("div",{style:{height:52,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100",children:[e.jsxs("div",{className:"between",children:[d.data.name,((h=u.user)==null?void 0:h.role)==="0"&&e.jsx(k,{title:"删除将无法恢复,确定删除?",onConfirm:()=>n(d.data.id),children:e.jsx(g,{children:" 删除"})})]}),e.jsx("div",{children:e.jsx(b,{children:e.jsxs("span",{children:["创建人：",d.data.userName||"--"]})})})]})},d.data.id)})})})]})},Me=({children:t,...a})=>p.isValidElement(t)?p.cloneElement(t,{...a}):t,C=({title:t,btnName:a,children:s,...n})=>{const[r,o]=De({open:!1});return e.jsxs(e.Fragment,{children:[e.jsx(g,{type:"link",onClick:()=>o({open:!0}),children:a}),e.jsx(he,{destroyOnClose:!0,open:r.open,title:t,placement:"right",width:"100%",onClose:()=>o({open:!1}),children:e.jsx(Me,{onClose:()=>o({open:!1}),...n,children:r&&s})})]})},Oe=()=>{const{login:t}=A(),{state:a}=p.useContext(E);return e.jsxs(i,{...R,name:"login",onFinish:t,scrollToFirstError:!0,children:[e.jsx(i.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(j,{className:"w-100"})}),e.jsx(i.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(j.Password,{})}),e.jsx(i.Item,{...L,children:e.jsx(g,{loading:a.loading,type:"primary",htmlType:"submit",children:"登录"})})]})},_e=({onClose:t})=>{const{register:a}=A(),{state:s}=p.useContext(E);return e.jsxs(i,{...R,name:"register",onFinish:n=>a(n,t),scrollToFirstError:!0,children:[e.jsx(i.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入你的昵称!",whitespace:!0}],children:e.jsx(j,{})}),e.jsx(i.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(j,{className:"w-100"})}),e.jsx(i.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(j.Password,{})}),e.jsx(i.Item,{name:"confirm",label:"确认密码",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"请再次输入密码!"},({getFieldValue:n})=>({validator(r,o){return!o||n("password")===o?Promise.resolve():Promise.reject(new Error("两次密码不匹配!"))}})],children:e.jsx(j.Password,{})}),e.jsx(i.Item,{...L,children:e.jsx(g,{loading:s.loading,type:"primary",htmlType:"submit",children:"注册"})})]})},He=()=>{const t=p.useRef(null),a=p.useRef(null),{users:s,delUser:n,getUsers:r}=A(),{state:o}=p.useContext(E),[u]=z(s,{containerTarget:t,wrapperTarget:a,itemHeight:60,overscan:10});return q(()=>{r()}),e.jsx("div",{ref:t,style:{height:window.innerHeight/2,overflow:"auto"},children:e.jsx("div",{ref:a,children:u.map(m=>{var d;return e.jsx("div",{style:{height:52,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100",children:[e.jsxs("div",{className:"between",children:["用户名：",m.data.nickname,((d=o.user)==null?void 0:d.role)==="0"&&e.jsx(k,{title:"删除将无法恢复,确定删除?",onConfirm:()=>n(m.data),children:e.jsx(g,{children:" 删除"})})]}),e.jsx("div",{children:e.jsxs(b,{children:[e.jsxs("span",{children:["创建日期：",T(m.data.createdAt).subtract(8,"h").format("YYYY-MM-DD")]}),e.jsxs("span",{children:["更新日期：",T(m.data.updatedAt).subtract(8,"h").format("YYYY-MM-DD")]})]})})]})},m.data.id)})})})},Ve=({onClose:t})=>{const{getAllTodo:a}=A(),{state:s}=p.useContext(E);return e.jsxs(i,{initialValues:{operationSource:"h5",isFinish:"0"},...R,name:"search",onFinish:n=>{a(n),t()},scrollToFirstError:!0,children:[e.jsx(i.Item,{name:"name",label:"名称",children:e.jsx(j,{className:"w-100"})}),e.jsx(i.Item,{name:"tagId",label:"标签",children:e.jsx(v,{className:"w-100",options:s.tags.map(n=>({label:`${n.name}-(${n.userName})`,value:n.id}))})}),e.jsx(i.Item,{name:"operationSource",label:"来源",children:e.jsx(v,{className:"w-100",options:[{label:"h5",value:"h5"},{label:"微信",value:"wx"}]})}),e.jsx(i.Item,{name:"isFinish",label:"状态",children:e.jsx(v,{className:"w-100",options:[{label:"进行中",value:"0"},{label:"已完成",value:"1"}]})}),e.jsx(i.Item,{...L,children:e.jsx(g,{loading:s.loading,type:"primary",htmlType:"submit",children:"搜索"})})]})},{Header:ze,Content:qe}=H,$e=()=>{const{signOut:t,getAllTodo:a,switchService:s,goPage:n}=A(),{state:r}=p.useContext(E),o=[{key:"0",label:e.jsx(C,{title:"标签",btnName:"标签",children:e.jsx(Fe,{})})},{key:"1",label:e.jsx(C,{title:"登陆",btnName:"登陆",children:e.jsx(Oe,{})})},{key:"2",label:e.jsx(C,{title:"注册",btnName:"注册",children:e.jsx(_e,{})})},{key:"3",label:r.user&&r.user.role==="0"&&e.jsx(C,{title:"用户管理",btnName:"用户管理",children:e.jsx(He,{})})},{key:"4",label:e.jsx(g,{type:"link",onClick:t,children:"登出"})},{key:"5",label:e.jsx(g,{type:"link",onClick:s,children:localStorage.getItem("USE_LOCAL_SERVICE")==="0"?"本地环境":"线上环境"})}];return e.jsxs(H,{className:"ndzy-layout",children:[e.jsx(ze,{className:"ndzy-header",children:e.jsxs(b,{className:"mb-16",children:[r.user?e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:r.user.name||r.user.nickname}):e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:"游客"}),e.jsx(g,{type:"link",onClick:()=>n("/ndzy-todos"),children:"home"}),e.jsx(g,{type:"link",onClick:()=>n("/ndzy-todos/records"),children:"records"}),e.jsx(C,{title:"新建",btnName:"新建",children:e.jsx(W,{})}),e.jsx(C,{title:"搜索",btnName:"搜索",children:e.jsx(Ve,{})}),e.jsx(g,{type:"link",onClick:()=>a(),children:"重置"}),e.jsx(xe,{menu:{items:o},children:e.jsx("a",{onClick:u=>u.preventDefault(),children:"其他"})})]})}),e.jsx(qe,{children:e.jsx("div",{className:"layout-content p-16",children:e.jsx(Ae,{})})})]})},Ge=({value:t})=>{const a=K();return e.jsx("div",{style:{padding:"0 8px"},id:`preview-${a}`,className:"ndzy-preview",dangerouslySetInnerHTML:{__html:t}})},Ke=t=>e.jsxs(C,{title:"查看",btnName:"查看",children:[e.jsx(Ge,{value:t.detail}),e.jsx("div",{children:e.jsxs(b,{children:[e.jsxs("span",{style:{color:"blue"},children:["创建人：",t.userName||"--"]}),e.jsxs("span",{style:{color:"green"},children:["标签：",t.tagName||"--"]}),e.jsxs("span",{style:{color:"red"},children:["终止日期：",T(t.deadline).format("YYYY-MM-DD")]})]})}),e.jsx("div",{children:e.jsxs(b,{children:[e.jsxs("span",{children:["创建日期：",T(t.createdAt).subtract(8,"h").format("YYYY-MM-DD")]}),e.jsxs("span",{children:["更新日期：",T(t.updatedAt).subtract(8,"h").format("YYYY-MM-DD")]})]})})]}),We=()=>{const{state:t}=p.useContext(E),{initUser:a,initTags:s,getAllTodo:n,finishTodo:r,delTodo:o,recoverTodo:u}=A();q(()=>{a(),s(),n()});const m=[{title:"名称",dataIndex:"name",width:80},{title:"进度",dataIndex:"deadline",width:80,render:(d,h)=>{if(Number(h.isFinish)===0)return e.jsx("span",{style:{color:"red"},children:"处理中"});if(Number(h.isFinish)===1)return e.jsx("span",{style:{color:"green"},children:"已完成"})}},{title:"截止日期",dataIndex:"deadline",width:80},{title:"标签",dataIndex:"tagName",width:80},{title:"用户",dataIndex:"userName",width:80},{title:"创建时间",dataIndex:"createdAt",width:120},{title:"更新时间",dataIndex:"updatedAt",width:120},{title:"操作",width:100,fixed:"right",render:(d,h)=>e.jsxs(b,{children:[e.jsx(Ke,{...h}),Number(h.isFinish)===0?e.jsxs(b,{children:[e.jsx(C,{title:"编辑",btnName:"编辑",...h,children:e.jsx(W,{})}),e.jsx(g,{type:"link",onClick:()=>r(h),children:"完成"})]}):Number(h.isFinish)===1?e.jsxs(b,{children:[e.jsx(g,{type:"link",onClick:()=>u(h),children:"恢复"}),e.jsx(k,{title:"删除将无法恢复,确定删除?",onConfirm:()=>o(h),children:e.jsx(g,{type:"link",children:" 删除"})})]}):null]})}];return e.jsxs("div",{children:[e.jsx("div",{className:"center",children:t.loading&&e.jsx(ge,{})}),e.jsx(V,{virtual:!0,columns:m,scroll:{x:2e3,y:600},rowKey:"id",dataSource:t.list,pagination:!1,locale:{emptyText:e.jsx("div",{className:"center",children:"暂无待办事项"})}})]})},Xe=()=>e.jsx("div",{className:"center",children:e.jsxs("div",{children:[e.jsx("h2",{children:"页面不存在"}),e.jsx("p",{children:e.jsx(ce,{to:"/",children:"返回首页"})})]})}),{Paragraph:_}=ye,Ze=()=>{const[t]=i.useForm(),{getAllRecord:a,addRecord:s,delRecord:n}=A(),{state:r}=p.useContext(E);B(()=>{a()},[]),B(()=>{t.setFieldsValue({name:"",txt:"",txtInfo:""})},[r.records]);const o=m=>{m&&s(m)},u=[{title:"名称",dataIndex:"name",width:60,render:m=>e.jsx(_,{copyable:!0,children:m})},{title:"txt",dataIndex:"txt",width:120,render:m=>e.jsx(_,{copyable:!0,children:m})},{title:"描述",dataIndex:"txtInfo",width:20},{title:"操作",width:20,fixed:"right",render:(m,d)=>{var h;return((h=r.user)==null?void 0:h.role)==="0"&&e.jsx(k,{title:"删除将无法恢复,确定删除?",onConfirm:()=>n(d.id),children:e.jsx(Ue,{})})}}];return e.jsxs("div",{children:[e.jsxs(i,{variant:"filled",style:{maxWidth:600},onFinish:o,form:t,children:[e.jsx(i.Item,{label:"name",name:"name",rules:[{required:!0,message:"不能为空"}],children:e.jsx(j,{placeholder:"请输入"})}),e.jsx(i.Item,{label:"txt",name:"txt",rules:[{required:!0,message:"不能为空"}],children:e.jsx(j,{placeholder:"请输入"})}),e.jsx(i.Item,{label:"txtInfo",name:"txtInfo",children:e.jsx(j,{placeholder:"请输入"})}),e.jsx(i.Item,{wrapperCol:{offset:6,span:16},children:e.jsx(g,{type:"primary",htmlType:"submit",loading:r.loading,children:"添加"})})]}),e.jsx(V,{virtual:!0,columns:u,scroll:{y:600},rowKey:"id",dataSource:r.records,pagination:!1,locale:{emptyText:e.jsx("div",{className:"center",children:"暂无待办事项"})}})]})},Je=()=>{const[t,a]=p.useReducer(ve,$);return e.jsx(fe,{locale:je,children:e.jsx(E.Provider,{value:{state:t,dispatch:a},children:e.jsx(Ce,{children:e.jsxs(D,{path:"/ndzy-todos/",element:e.jsx($e,{}),children:[e.jsx(D,{index:!0,element:e.jsx(We,{})}),e.jsx(D,{path:"/ndzy-todos/records",element:e.jsx(Ze,{})}),e.jsx(D,{path:"*",element:e.jsx(Xe,{})})]})})})})};de.createRoot(document.getElementById("root")).render(e.jsx(ie.StrictMode,{children:e.jsx(me,{children:e.jsx(Je,{})})}));
