import{r as m,j as e,a as ie}from"./react-Tf5a63N3.js";import{c as de}from"./react-dom-L-9RVvDo.js";import{L as ce,B as pe}from"./react-router-dom-3Tq_h__U.js";import{s as y,F as c,I as A,D as me,S as N,A as ue,B as x,a as I,P as M,b as he,T as xe,c as K,d as ge,e as ye,f as fe,C as je,z as Ae}from"./antd-LALlDf7d.js";import{d as T}from"./dayjs-I44_pL56.js";import{a as Te}from"./axios-G2rPRu76.js";import{C as f}from"./crypto-js-cnNLbfBj.js";import{a as De,O as Ee,d as Se,e as Y}from"./react-router-mYt393XH.js";import{Z as Ie,m as be,c as Ue,u as Ce}from"./@wangeditor-gzx6jVfq.js";import{u as W,a as we,b as Z,c as $}from"./ahooks-H1r1rAbr.js";import{O as Pe}from"./@ant-design-oGzNwhgm.js";import"./@babel-fXcOJB-X.js";import"./scheduler-iwWdm5Ml.js";import"./@remix-run-1q7uUoWE.js";import"./rc-util-44hGjeVP.js";import"./react-is-q81m-9gd.js";import"./classnames-RRvKwVVO.js";import"./rc-resize-observer-ck5JqIRG.js";import"./resize-observer-polyfill-B32NGzNS.js";import"./rc-motion-7vv53bTg.js";import"./rc-picker-xixrHE6j.js";import"./@rc-component-oibO48Qt.js";import"./rc-menu-Q3iJPZGu.js";import"./rc-overflow-VxRkfzAh.js";import"./rc-select-WtCpbyab.js";import"./rc-virtual-list-BXD3VVHE.js";import"./@ctrl-_Y40OLZn.js";import"./rc-drawer-fZgySpmT.js";import"./rc-field-form-Rdl82lVd.js";import"./async-validator-BHjhHa7C.js";import"./rc-notification-7I1nwpoC.js";import"./rc-tooltip-dc6ms-Ot.js";import"./rc-table-PhNwxsIQ.js";import"./rc-tree-xZ6JQgv9.js";import"./rc-checkbox-bfzdVFQB.js";import"./rc-dropdown-QKhfUTW0.js";import"./rc-pagination-6SoAqjZS.js";import"./throttle-debounce-5p4B7Tol.js";import"./copy-to-clipboard-ds7YnVhZ.js";import"./toggle-selection-fekekO1r.js";import"./rc-textarea-Ly7unUNs.js";import"./rc-input-zn8sb5C_.js";import"./lodash-o2jpNBUl.js";import"./tslib-9i2l26Ba.js";import"./@emotion-folQEnri.js";import"./stylis-3miXmfPm.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(r){if(r.ep)return;r.ep=!0;const l=a(r);fetch(r.href,l)}})();const G={loading:!1,list:[],tags:[],records:[]},ke=(t,s)=>{switch(s.type){case"UPDATE":return{...t,...s.payload||{}};default:return t}},E=m.createContext({state:G,dispatch:()=>{}});y.config({top:100,duration:3,maxCount:1});if(!localStorage.getItem("DATA")){const t={todoList:[]};localStorage.setItem("DATA",JSON.stringify(t))}localStorage.getItem("USE_LOCAL_DATA")||localStorage.setItem("USE_LOCAL_DATA","0");localStorage.getItem("USE_LOCAL_SERVICE")||localStorage.setItem("USE_LOCAL_SERVICE","0");localStorage.getItem("BASE_URL")||localStorage.setItem("BASE_URL","http://localhost:3000");const z=localStorage.getItem("BASE_URL"),Le=(localStorage.getItem("USE_LOCAL_SERVICE")||"0")==="0",ve=Le&&z?z:"https://ndzy-server.vercel.app",h=Te.create({baseURL:ve,timeout:6e4,withCredentials:!1});h.interceptors.request.use(t=>{const s=localStorage.getItem("token");return s&&(t.headers={Authorization:"Basic "+s}),t},t=>{Promise.reject(t)});h.interceptors.response.use(t=>{const s=t.data;return t.data.status===1&&y.error(t.data.msg),t.data.status===0&&y.success(t.data.msg),t.data.status===2&&localStorage.setItem("token",""),s},t=>{let s="";if(t&&t.response)switch(t.response.status){case 302:s="接口重定向了！",y.error(s);break;case 400:s="参数不正确！",y.error(s);break;case 401:break;case 403:s="您没有权限操作！",y.error(s);break;case 404:s=`请求地址出错: ${t.response.config.url}`,y.error(s);break;case 408:s="请求超时！",y.error(s);break;case 409:s="系统已存在相同数据！",y.error(s);break;case 500:s="服务器内部错误！",y.error(s);break;case 501:s="服务未实现！",y.error(s);break;case 502:s="网关错误！",y.error(s);break;case 503:s="服务不可用！",y.error(s);break;case 504:s="服务暂时无法访问，请稍后再试！",y.error(s);break;case 505:s="HTTP 版本不受支持！",y.error(s);break;default:s="异常问题，请联系管理员！",y.error(s);break}return Promise.reject(s)});const Ne=t=>t&&t<T().endOf("day"),F=()=>{let t=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const n=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(a=="x"?n:n&3|8).toString(16)})},J=()=>{let t="";for(let s=0;s<8;s++)t+=F().replace(/-/g,"");return t},O=(t,s,a)=>{const n=f.enc.Utf8.parse(s),r=f.enc.Utf8.parse(a),l=f.enc.Hex.parse(t),i=f.enc.Base64.stringify(l);return f.AES.decrypt(i,n,{iv:r,mode:f.mode.CBC,padding:f.pad.Pkcs7,hasher:f.algo.SHA256}).toString(f.enc.Utf8).toString()},v=t=>{const s=J(),a=J(),n=f.enc.Utf8.parse(s),r=f.enc.Utf8.parse(a),l=f.enc.Utf8.parse(t),i=f.AES.encrypt(l,n,{iv:r,mode:f.mode.CBC,padding:f.pad.Pkcs7,hasher:f.algo.SHA256});return{keyBase:s,ivBase:a,text:i.ciphertext.toString().toUpperCase()}},V={labelCol:{xs:{span:6},sm:{span:6}},wrapperCol:{xs:{span:18},sm:{span:18}}},H={wrapperCol:{span:14,offset:2}},U=()=>{const t=(localStorage.getItem("USE_LOCAL_DATA")||"0")==="0",s=De(),{dispatch:a}=m.useContext(E),[n,r]=m.useState(""),[l,i]=m.useState([]),g=(o,d={})=>{s(o,{...d})},u=()=>{a({type:"UPDATE",payload:{loading:!0}}),h.get("/users/loginInfo").then(o=>{a({type:"UPDATE",payload:{user:o.data[0],loading:!1}})}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},C=()=>{a({type:"UPDATE",payload:{loading:!0}}),h("/tags").then(o=>{a({type:"UPDATE",payload:{tags:o.data,loading:!1}})}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},D=(o={})=>{if(a({type:"UPDATE",payload:{loading:!0}}),t){const d=JSON.parse(localStorage.getItem("DATA"));a({type:"UPDATE",payload:{list:d.todoList.map(p=>({...p,detail:O(p.detail,p.keyBase,p.ivBase)})),loading:!1}})}else h.get("/todos",{params:{...o}}).then(d=>{a({type:"UPDATE",payload:{list:d.data.map(p=>({...p,detail:O(p.detail,p.keyBase,p.ivBase)})),loading:!1}})}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},j=(o,d)=>{a({type:"UPDATE",payload:{loading:!0}});const{text:p,keyBase:b,ivBase:w}=v(o.detail);if(t){const P=JSON.parse(localStorage.getItem("DATA"));P.todoList.push({id:F(),...o,deadline:T(o.deadline).format("YYYY-MM-DD"),operationSource:"h5",detail:p,keyBase:b,ivBase:w,isLocal:!0}),localStorage.setItem("DATA",JSON.stringify(P)),a({type:"UPDATE",payload:{list:P.todoList,loading:!1}}),D(),d&&d()}else h.post("/todos",{...o,deadline:T(o.deadline).format("YYYY-MM-DD"),operationSource:"h5",detail:p,keyBase:b,ivBase:w}).then(()=>{a({type:"UPDATE",payload:{loading:!1}}),D(),d&&d()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},Q=(o,d,p)=>{a({type:"UPDATE",payload:{loading:!0}});const{text:b,keyBase:w,ivBase:P}=v(o.detail);if(t){const L=JSON.parse(localStorage.getItem("DATA"));L.todoList=L.todoList.map(R=>R.id===d.id?{...R,name:o.name,detail:b,keyBase:w,ivBase:P,deadline:T(o.deadline).format("YYYY-MM-DD"),tagId:o.tagId}:R),localStorage.setItem("DATA",JSON.stringify(L)),a({type:"UPDATE",payload:{list:L.todoList,loading:!1}}),D(),p&&p()}else h.patch(`/todos/${d.id}`,{name:o.name,detail:b,keyBase:w,ivBase:P,deadline:T(o.deadline).format("YYYY-MM-DD"),tagId:o.tagId}).then(()=>{a({type:"UPDATE",payload:{loading:!1}}),D(),p&&p()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},X=o=>{a({type:"UPDATE",payload:{loading:!0}}),h.patch(`/todos/${o.id}`,{isFinish:!0}).then(()=>{D()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},ee=o=>{a({type:"UPDATE",payload:{loading:!0}}),h.delete(`/todos/${o.id}`).then(()=>{D()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},te=o=>{a({type:"UPDATE",payload:{loading:!0}}),h.patch(`/todos/${o.id}`,{isFinish:!1}).then(()=>{D()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},ae=()=>{localStorage.setItem("token",""),g("/ndzy-todos/"),window.location.reload()},se=o=>{a({type:"UPDATE",payload:{loading:!0}}),h.post("/users/login",{...o}).then(d=>{a({type:"UPDATE",payload:{loading:!1}}),d&&d.data&&d.data.token&&(localStorage.setItem("token",d.data.token),g("/ndzy-todos/"),window.location.reload())}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},oe=(o,d)=>{a({type:"UPDATE",payload:{loading:!0}}),h.post("/users/register",{...o}).then(p=>{a({type:"UPDATE",payload:{loading:!1}}),p.status===0&&d&&d()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},re=o=>{a({type:"UPDATE",payload:{loading:!0}}),h.delete(`/tags/${o}`).then(()=>{C()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},ne=()=>{n&&(a({type:"UPDATE",payload:{loading:!0}}),h.post("/tags",{name:n}).then(()=>{r(""),C()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})}))},q=async()=>{a({type:"UPDATE",payload:{loading:!0}}),u(),h.get("/users").then(o=>{a({type:"UPDATE",payload:{loading:!1}}),i(o.data)}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},le=o=>{a({type:"UPDATE",payload:{loading:!0}}),h.delete(`/users/${o.id}`).then(()=>{q()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},k=()=>{a({type:"UPDATE",payload:{loading:!0}}),h.get("/records").then(o=>{a({type:"UPDATE",payload:{records:o.data.map(d=>({...d,txt:O(d.txt,d.keyBase,d.ivBase)})),loading:!1}})}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})};return{inputValue:n,users:l,initUser:u,initTags:C,createTodo:j,editTodo:Q,goPage:g,getAllTodo:D,finishTodo:X,delTodo:ee,recoverTodo:te,signOut:ae,login:se,register:oe,delTag:re,handleCreateTag:ne,setInputValue:r,getUsers:q,delUser:le,isLocal:t,switchData:()=>{localStorage.getItem("USE_LOCAL_DATA")==="0"?localStorage.setItem("USE_LOCAL_DATA","1"):localStorage.setItem("USE_LOCAL_DATA","0"),window.location.reload()},switchService:()=>{localStorage.getItem("USE_LOCAL_SERVICE")==="0"?localStorage.setItem("USE_LOCAL_SERVICE","1"):localStorage.setItem("USE_LOCAL_SERVICE","0"),window.location.reload()},delLocalData:o=>{const d=JSON.parse(localStorage.getItem("DATA"));d.todoList=d.todoList.filter(p=>p.id!==o),localStorage.setItem("DATA",JSON.stringify(d)),a({type:"UPDATE",payload:{list:d.todoList,loading:!1}}),D()},getAllRecord:k,addRecord:o=>{a({type:"UPDATE",payload:{loading:!0}});const{text:d,keyBase:p,ivBase:b}=v(o.txt);h.post("/records",{...o,txt:d,keyBase:p,ivBase:b}).then(()=>{a({type:"UPDATE",payload:{loading:!1}}),k()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},updateRecord:(o,d)=>{a({type:"UPDATE",payload:{loading:!0}});const{text:p,keyBase:b,ivBase:w}=v(d.txt);h.patch(`/records/${o}`,{name:d.name,txt:p,keyBase:b,ivBase:w,txtInfo:d.txtInfo}).then(()=>{a({type:"UPDATE",payload:{loading:!1}}),k()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},delRecord:o=>{a({type:"UPDATE",payload:{loading:!0}}),h.delete(`/records/${o}`).then(()=>{k()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})}}};Ie.registerModule(be);function Re({value:t,onChange:s}){const[a,n]=m.useState(null),[r,l]=m.useState("");m.useEffect(()=>{l(t)},[t]);const i={},g={placeholder:"请输入内容..."};return m.useEffect(()=>()=>{a!=null&&(a.destroy(),n(null))},[a]),e.jsx(e.Fragment,{children:e.jsxs("div",{style:{border:"1px solid #ccc",zIndex:100},children:[e.jsx(Ue,{editor:a,defaultConfig:i,mode:"default",style:{borderBottom:"1px solid #ccc"}}),e.jsx(Ce,{defaultConfig:g,value:r,onCreated:n,onChange:u=>{l(u.getHtml()),s(u.getHtml())},mode:"default",style:{overflowY:"hidden",minHeight:330}})]})})}const B=t=>{const{createTodo:s,editTodo:a,isLocal:n}=U(),{state:r}=m.useContext(E),l=i=>t.id?a(i,{id:t.id},t.onClose):s(i,t.onClose);return e.jsxs(c,{initialValues:{name:t.name,deadline:t.deadline?T(t.deadline):T(),detail:t.detail,tagId:t.tagId},preserve:!1,name:"edit",onFinish:l,scrollToFirstError:!0,children:[e.jsx(c.Item,{name:"name",label:"名称",rules:[{required:!0,message:"名称不能为空"}],children:e.jsx(A.TextArea,{rows:1})}),e.jsx(c.Item,{name:"deadline",label:"终止时间",rules:[{required:!0,message:"终止时间不能为空"}],children:e.jsx(me,{className:"w-100",format:"YYYY-MM-DD",disabledDate:Ne})}),e.jsx(c.Item,{name:"detail",label:"详情",rules:[{required:!0,message:"详情不能为空"}],children:e.jsx(Re,{})}),e.jsx(c.Item,{name:"tagId",label:"标签",rules:[{required:!n,message:"请选择一个标签"}],children:e.jsx(N,{options:r.tags.map(i=>({label:`${i.name}-(${i.userName})`,value:i.id}))})}),e.jsx(c.Item,{children:e.jsx(ue,{offsetBottom:16,children:e.jsx(x,{loading:r.loading,type:"primary",htmlType:"submit",children:t.id?"保存":"创建"})})})]})},Ye=()=>{const t=m.useRef(null),s=m.useRef(null),{inputValue:a,delTag:n,handleCreateTag:r,setInputValue:l}=U(),{state:i}=m.useContext(E),[g]=W(i.tags,{containerTarget:t,wrapperTarget:s,itemHeight:60,overscan:10});return e.jsxs("div",{children:[e.jsxs(I.Compact,{className:"w-100",children:[e.jsx(A,{placeholder:"请输入",value:a,onChange:u=>l(u.target.value)}),e.jsx(x,{loading:i.loading,type:"primary",onClick:r,children:"添加"})]}),e.jsx("div",{ref:t,style:{height:window.innerHeight/2,overflow:"auto",marginTop:16},children:e.jsx("div",{ref:s,children:g.map(u=>{var C;return e.jsx("div",{style:{height:52,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100",children:[e.jsxs("div",{className:"between",children:[u.data.name,((C=i.user)==null?void 0:C.role)==="0"&&e.jsx(M,{title:"删除将无法恢复,确定删除?",onConfirm:()=>n(u.data.id),children:e.jsx(x,{children:" 删除"})})]}),e.jsx("div",{children:e.jsx(I,{children:e.jsxs("span",{children:["创建人：",u.data.userName||"--"]})})})]})},u.data.id)})})})]})},Oe=({children:t,...s})=>m.isValidElement(t)?m.cloneElement(t,{...s}):t,S=({title:t,btnName:s,children:a,...n})=>{const[r,l]=we({open:!1});return e.jsxs(e.Fragment,{children:[e.jsx(x,{type:"link",onClick:()=>l({open:!0}),children:s}),e.jsx(he,{destroyOnClose:!0,open:r.open,title:t,placement:"right",width:"100%",onClose:()=>l({open:!1}),children:e.jsx(Oe,{onClose:()=>l({open:!1}),...n,children:r&&a})})]})},_e=()=>{const{login:t}=U(),{state:s}=m.useContext(E);return e.jsxs(c,{...V,name:"login",onFinish:t,scrollToFirstError:!0,children:[e.jsx(c.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(A,{className:"w-100"})}),e.jsx(c.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(A.Password,{})}),e.jsx(c.Item,{...H,children:e.jsx(x,{loading:s.loading,type:"primary",htmlType:"submit",children:"登录"})})]})},Be=({onClose:t})=>{const{register:s}=U(),{state:a}=m.useContext(E);return e.jsxs(c,{...V,name:"register",onFinish:n=>s(n,t),scrollToFirstError:!0,children:[e.jsx(c.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入你的昵称!",whitespace:!0}],children:e.jsx(A,{})}),e.jsx(c.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(A,{className:"w-100"})}),e.jsx(c.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(A.Password,{})}),e.jsx(c.Item,{name:"confirm",label:"确认密码",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"请再次输入密码!"},({getFieldValue:n})=>({validator(r,l){return!l||n("password")===l?Promise.resolve():Promise.reject(new Error("两次密码不匹配!"))}})],children:e.jsx(A.Password,{})}),e.jsx(c.Item,{...H,children:e.jsx(x,{loading:a.loading,type:"primary",htmlType:"submit",children:"注册"})})]})},Me=()=>{const t=m.useRef(null),s=m.useRef(null),{users:a,delUser:n,getUsers:r}=U(),{state:l}=m.useContext(E),[i]=W(a,{containerTarget:t,wrapperTarget:s,itemHeight:60,overscan:10});return Z(()=>{r()}),e.jsx("div",{ref:t,style:{height:window.innerHeight/2,overflow:"auto"},children:e.jsx("div",{ref:s,children:i.map(g=>{var u;return e.jsx("div",{style:{height:52,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100",children:[e.jsxs("div",{className:"between",children:["用户名：",g.data.nickname,((u=l.user)==null?void 0:u.role)==="0"&&e.jsx(M,{title:"删除将无法恢复,确定删除?",onConfirm:()=>n(g.data),children:e.jsx(x,{children:" 删除"})})]}),e.jsx("div",{children:e.jsxs(I,{children:[e.jsxs("span",{children:["创建日期：",T(g.data.createdAt).subtract(8,"h").format("YYYY-MM-DD")]}),e.jsxs("span",{children:["更新日期：",T(g.data.updatedAt).subtract(8,"h").format("YYYY-MM-DD")]})]})})]})},g.data.id)})})})},Fe=({onClose:t})=>{const{getAllTodo:s}=U(),{state:a}=m.useContext(E);return e.jsxs(c,{initialValues:{operationSource:"h5",isFinish:"0"},...V,name:"search",onFinish:n=>{s(n),t()},scrollToFirstError:!0,children:[e.jsx(c.Item,{name:"name",label:"名称",children:e.jsx(A,{className:"w-100"})}),e.jsx(c.Item,{name:"tagId",label:"标签",children:e.jsx(N,{className:"w-100",options:a.tags.map(n=>({label:`${n.name}-(${n.userName})`,value:n.id}))})}),e.jsx(c.Item,{name:"operationSource",label:"来源",children:e.jsx(N,{className:"w-100",options:[{label:"h5",value:"h5"},{label:"微信",value:"wx"}]})}),e.jsx(c.Item,{name:"isFinish",label:"状态",children:e.jsx(N,{className:"w-100",options:[{label:"进行中",value:"0"},{label:"已完成",value:"1"}]})}),e.jsx(c.Item,{...H,children:e.jsx(x,{loading:a.loading,type:"primary",htmlType:"submit",children:"搜索"})})]})},{Paragraph:_}=xe,Ve=()=>{const[t]=c.useForm(),{getAllRecord:s,addRecord:a,delRecord:n}=U(),{state:r}=m.useContext(E);$(()=>{s()},[]),$(()=>{t.setFieldsValue({name:"",txt:"",txtInfo:""})},[r.records]);const l=i=>{i&&a(i)};return e.jsxs(e.Fragment,{children:[e.jsxs(c,{variant:"filled",style:{maxWidth:600},onFinish:l,form:t,children:[e.jsx(c.Item,{label:"name",name:"name",rules:[{required:!0,message:"不能为空"}],children:e.jsx(A,{placeholder:"请输入"})}),e.jsx(c.Item,{label:"txt",name:"txt",rules:[{required:!0,message:"不能为空"}],children:e.jsx(A,{placeholder:"请输入"})}),e.jsx(c.Item,{label:"txtInfo",name:"txtInfo",children:e.jsx(A,{placeholder:"请输入"})}),e.jsx(c.Item,{wrapperCol:{offset:6,span:16},children:e.jsx(x,{type:"primary",htmlType:"submit",loading:r.loading,children:"添加"})})]}),r.records.map(i=>e.jsxs(I,{style:{display:"flex",marginBottom:8},align:"baseline",children:[e.jsx(c.Item,{label:"名称",children:e.jsx(_,{copyable:!0,children:i.name})}),e.jsx(c.Item,{label:"内容",children:e.jsx(_,{copyable:!0,children:i.txt})}),e.jsx(c.Item,{label:"描述",children:e.jsx(_,{copyable:!0,children:i.txtInfo})}),e.jsx(Pe,{onClick:()=>n(i.id)})]},i.id))]})},{Header:He,Content:qe}=K,$e=()=>{const{signOut:t,getAllTodo:s,switchData:a,switchService:n}=U(),{state:r}=m.useContext(E),l=[{key:"0",label:e.jsx(S,{title:"标签",btnName:"标签",children:e.jsx(Ye,{})})},{key:"1",label:e.jsx(S,{title:"登陆",btnName:"登陆",children:e.jsx(_e,{})})},{key:"2",label:e.jsx(S,{title:"注册",btnName:"注册",children:e.jsx(Be,{})})},{key:"3",label:r.user&&r.user.role==="0"&&e.jsx(S,{title:"用户管理",btnName:"用户管理",children:e.jsx(Me,{})})},{key:"4",label:e.jsx(x,{type:"link",onClick:t,children:"登出"})},{key:"5",label:e.jsx(x,{type:"link",onClick:n,children:localStorage.getItem("USE_LOCAL_SERVICE")==="0"?"本地环境":"线上环境"})},{key:"6",label:e.jsx(x,{type:"link",onClick:a,children:localStorage.getItem("USE_LOCAL_DATA")==="0"?"本地数据":"接口数据"})}];return e.jsxs(K,{className:"ndzy-layout",children:[e.jsx(He,{className:"ndzy-header",children:e.jsxs(I,{className:"mb-16",children:[r.user?e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:r.user.name||r.user.nickname}):e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:"游客"}),e.jsx(S,{title:"record",btnName:"record",children:e.jsx(Ve,{})}),e.jsx(S,{title:"新建",btnName:"新建",children:e.jsx(B,{})}),e.jsx(S,{title:"搜索",btnName:"搜索",children:e.jsx(Fe,{})}),e.jsx(x,{type:"link",onClick:()=>s(),children:"重置"}),e.jsx(ge,{menu:{items:l},children:e.jsx("a",{onClick:i=>i.preventDefault(),children:"其他"})})]})}),e.jsx(qe,{children:e.jsx("div",{className:"layout-content p-16",children:e.jsx(Ee,{})})})]})},ze=({value:t})=>{const s=F();return e.jsx("div",{style:{padding:"0 8px"},id:`preview-${s}`,className:"ndzy-preview",dangerouslySetInnerHTML:{__html:t}})},Je=t=>e.jsxs(S,{title:"查看",btnName:"查看",children:[e.jsx(ze,{value:t.detail}),e.jsx("div",{children:e.jsxs(I,{children:[e.jsxs("span",{style:{color:"blue"},children:["创建人：",t.userName||"--"]}),e.jsxs("span",{style:{color:"green"},children:["标签：",t.tagName||"--"]}),e.jsxs("span",{style:{color:"red"},children:["终止日期：",T(t.deadline).format("YYYY-MM-DD")]})]})}),e.jsx("div",{children:e.jsxs(I,{children:[e.jsxs("span",{children:["创建日期：",T(t.createdAt).subtract(8,"h").format("YYYY-MM-DD")]}),e.jsxs("span",{children:["更新日期：",T(t.updatedAt).subtract(8,"h").format("YYYY-MM-DD")]})]})})]}),Ke=()=>{const{state:t}=m.useContext(E),{initUser:s,initTags:a,getAllTodo:n,finishTodo:r,delTodo:l,recoverTodo:i,delLocalData:g,isLocal:u}=U();Z(()=>{s(),a(),n()});const C=[{title:"名称",dataIndex:"name",width:80},{title:"进度",dataIndex:"deadline",width:80,render:(D,j)=>{if(Number(j.isFinish)===0)return e.jsx("span",{style:{color:"red"},children:"处理中"});if(Number(j.isFinish)===1)return e.jsx("span",{style:{color:"green"},children:"已完成"})}},{title:"截止日期",dataIndex:"deadline",width:80},{title:"标签",dataIndex:"tagName",width:80},{title:"用户",dataIndex:"userName",width:80},{title:"创建时间",dataIndex:"createdAt",width:120},{title:"更新时间",dataIndex:"updatedAt",width:120},{title:"操作",width:100,fixed:"right",render:(D,j)=>e.jsxs(I,{children:[e.jsx(Je,{...j}),u&&e.jsx(S,{title:"编辑",btnName:"编辑",...j,children:e.jsx(B,{})}),u&&e.jsx(x,{type:"link",onClick:()=>g(j.id),children:"删除"}),u&&e.jsx(x,{type:"link",onClick:()=>{},children:"同步"}),Number(j.isFinish)===0?e.jsxs(I,{children:[e.jsx(S,{title:"编辑",btnName:"编辑",...j,children:e.jsx(B,{})}),e.jsx(x,{type:"link",onClick:()=>r(j),children:"完成"})]}):Number(j.isFinish)===1?e.jsxs(I,{children:[e.jsx(x,{type:"link",onClick:()=>i(j),children:"恢复"}),e.jsx(M,{title:"删除将无法恢复,确定删除?",onConfirm:()=>l(j),children:e.jsx(x,{type:"link",children:" 删除"})})]}):null]})}];return e.jsxs("div",{children:[e.jsx("div",{className:"center",children:t.loading&&e.jsx(ye,{})}),e.jsx(fe,{virtual:!0,columns:C,scroll:{x:2e3,y:600},rowKey:"id",dataSource:t.list,pagination:!1,locale:{emptyText:e.jsx("div",{className:"center",children:"暂无待办事项"})}})]})},We=()=>e.jsx("div",{className:"center",children:e.jsxs("div",{children:[e.jsx("h2",{children:"页面不存在"}),e.jsx("p",{children:e.jsx(ce,{to:"/",children:"返回首页"})})]})}),Ze=()=>{const[t,s]=m.useReducer(ke,G);return e.jsx(je,{locale:Ae,children:e.jsx(E.Provider,{value:{state:t,dispatch:s},children:e.jsx(Se,{children:e.jsxs(Y,{path:"/ndzy-todos/",element:e.jsx($e,{}),children:[e.jsx(Y,{index:!0,element:e.jsx(Ke,{})}),e.jsx(Y,{path:"*",element:e.jsx(We,{})})]})})})})};de.createRoot(document.getElementById("root")).render(e.jsx(ie.StrictMode,{children:e.jsx(pe,{children:e.jsx(Ze,{})})}));
