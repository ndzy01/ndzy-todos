import{r as u,j as e,a as de}from"./react-Tf5a63N3.js";import{c as ce}from"./react-dom-L-9RVvDo.js";import{L as pe,B as me}from"./react-router-dom-3Tq_h__U.js";import{s as y,F as c,I as A,D as ue,S as N,A as he,B as g,a as U,P as R,b as xe,T as K,c as ge,d as W,e as ye,f as fe,C as je,z as Ae}from"./antd-KhHrb4yM.js";import{d as T}from"./dayjs-I44_pL56.js";import{a as Te}from"./axios-G2rPRu76.js";import{C as f}from"./crypto-js-cnNLbfBj.js";import{a as De,O as Ee,d as Se,e as _}from"./react-router-mYt393XH.js";import{Z as Ie,m as be,c as Ue,u as Ce}from"./@wangeditor-gzx6jVfq.js";import{u as Z,a as we,b as G,c as q}from"./ahooks-H1r1rAbr.js";import{O as Pe}from"./@ant-design-oGzNwhgm.js";import"./@babel-fXcOJB-X.js";import"./scheduler-iwWdm5Ml.js";import"./@remix-run-1q7uUoWE.js";import"./rc-util-44hGjeVP.js";import"./react-is-q81m-9gd.js";import"./classnames-RRvKwVVO.js";import"./rc-resize-observer-ck5JqIRG.js";import"./resize-observer-polyfill-B32NGzNS.js";import"./rc-motion-7vv53bTg.js";import"./rc-picker-xixrHE6j.js";import"./@rc-component-oibO48Qt.js";import"./rc-menu-Q3iJPZGu.js";import"./rc-overflow-VxRkfzAh.js";import"./rc-select-WtCpbyab.js";import"./rc-virtual-list-BXD3VVHE.js";import"./@ctrl-_Y40OLZn.js";import"./rc-drawer-fZgySpmT.js";import"./rc-field-form-Rdl82lVd.js";import"./async-validator-BHjhHa7C.js";import"./rc-notification-7I1nwpoC.js";import"./rc-tooltip-dc6ms-Ot.js";import"./rc-table-PhNwxsIQ.js";import"./rc-tree-xZ6JQgv9.js";import"./rc-checkbox-bfzdVFQB.js";import"./rc-dropdown-QKhfUTW0.js";import"./rc-pagination-6SoAqjZS.js";import"./throttle-debounce-5p4B7Tol.js";import"./copy-to-clipboard-ds7YnVhZ.js";import"./toggle-selection-fekekO1r.js";import"./rc-textarea-Ly7unUNs.js";import"./rc-input-zn8sb5C_.js";import"./lodash-o2jpNBUl.js";import"./tslib-9i2l26Ba.js";import"./@emotion-folQEnri.js";import"./stylis-3miXmfPm.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function a(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=a(o);fetch(o.href,l)}})();const Q={loading:!1,list:[],tags:[],records:[]},ke=(t,s)=>{switch(s.type){case"UPDATE":return{...t,...s.payload||{}};default:return t}},S=u.createContext({state:Q,dispatch:()=>{}});y.config({top:100,duration:3,maxCount:1});if(!localStorage.getItem("DATA")){const t={todoList:[]};localStorage.setItem("DATA",JSON.stringify(t))}localStorage.getItem("USE_LOCAL_DATA")||localStorage.setItem("USE_LOCAL_DATA","0");localStorage.getItem("USE_LOCAL_SERVICE")||localStorage.setItem("USE_LOCAL_SERVICE","0");localStorage.getItem("BASE_URL")||localStorage.setItem("BASE_URL","http://localhost:3000");const $=localStorage.getItem("BASE_URL"),Le=(localStorage.getItem("USE_LOCAL_SERVICE")||"0")==="0",ve=Le&&$?$:"https://ndzy-server.vercel.app",x=Te.create({baseURL:ve,timeout:6e4,withCredentials:!1});x.interceptors.request.use(t=>{const s=localStorage.getItem("token");return s&&(t.headers={Authorization:"Basic "+s}),t},t=>{Promise.reject(t)});x.interceptors.response.use(t=>{const s=t.data;return t.data.status===1&&y.error(t.data.msg),t.data.status===0&&y.success(t.data.msg),t.data.status===2&&localStorage.setItem("token",""),s},t=>{let s="";if(t&&t.response)switch(t.response.status){case 302:s="接口重定向了！",y.error(s);break;case 400:s="参数不正确！",y.error(s);break;case 401:break;case 403:s="您没有权限操作！",y.error(s);break;case 404:s=`请求地址出错: ${t.response.config.url}`,y.error(s);break;case 408:s="请求超时！",y.error(s);break;case 409:s="系统已存在相同数据！",y.error(s);break;case 500:s="服务器内部错误！",y.error(s);break;case 501:s="服务未实现！",y.error(s);break;case 502:s="网关错误！",y.error(s);break;case 503:s="服务不可用！",y.error(s);break;case 504:s="服务暂时无法访问，请稍后再试！",y.error(s);break;case 505:s="HTTP 版本不受支持！",y.error(s);break;default:s="异常问题，请联系管理员！",y.error(s);break}return Promise.reject(s)});const Ne=t=>t&&t<T().endOf("day"),M=()=>{let t=new Date().getTime();return typeof performance<"u"&&typeof performance.now=="function"&&(t+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{const n=(t+Math.random()*16)%16|0;return t=Math.floor(t/16),(a=="x"?n:n&3|8).toString(16)})},z=()=>{let t="";for(let s=0;s<8;s++)t+=M().replace(/-/g,"");return t},O=(t,s,a)=>{const n=f.enc.Utf8.parse(s),o=f.enc.Utf8.parse(a),l=f.enc.Hex.parse(t),d=f.enc.Base64.stringify(l);return f.AES.decrypt(d,n,{iv:o,mode:f.mode.CBC,padding:f.pad.Pkcs7,hasher:f.algo.SHA256}).toString(f.enc.Utf8).toString()},v=t=>{const s=z(),a=z(),n=f.enc.Utf8.parse(s),o=f.enc.Utf8.parse(a),l=f.enc.Utf8.parse(t),d=f.AES.encrypt(l,n,{iv:o,mode:f.mode.CBC,padding:f.pad.Pkcs7,hasher:f.algo.SHA256});return{keyBase:s,ivBase:a,text:d.ciphertext.toString().toUpperCase()}},F={labelCol:{xs:{span:6},sm:{span:6}},wrapperCol:{xs:{span:18},sm:{span:18}}},V={wrapperCol:{span:14,offset:2}},C=()=>{const t=(localStorage.getItem("USE_LOCAL_DATA")||"0")==="0",s=De(),{dispatch:a}=u.useContext(S),[n,o]=u.useState(""),[l,d]=u.useState([]),m=(r,i={})=>{s(r,{...i})},h=()=>{a({type:"UPDATE",payload:{loading:!0}}),x.get("/users/loginInfo").then(r=>{a({type:"UPDATE",payload:{user:r.data[0],loading:!1}})}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},D=()=>{a({type:"UPDATE",payload:{loading:!0}}),x("/tags").then(r=>{a({type:"UPDATE",payload:{tags:r.data,loading:!1}})}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},E=(r={})=>{if(a({type:"UPDATE",payload:{loading:!0}}),t){const i=JSON.parse(localStorage.getItem("DATA"));a({type:"UPDATE",payload:{list:i.todoList.map(p=>({...p,detail:O(p.detail,p.keyBase,p.ivBase)})),loading:!1}})}else x.get("/todos",{params:{...r}}).then(i=>{a({type:"UPDATE",payload:{list:i.data.map(p=>({...p,detail:O(p.detail,p.keyBase,p.ivBase)})),loading:!1}})}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},j=(r,i)=>{a({type:"UPDATE",payload:{loading:!0}});const{text:p,keyBase:b,ivBase:w}=v(r.detail);if(t){const P=JSON.parse(localStorage.getItem("DATA"));P.todoList.push({id:M(),...r,deadline:T(r.deadline).format("YYYY-MM-DD"),operationSource:"h5",detail:p,keyBase:b,ivBase:w,isLocal:!0}),localStorage.setItem("DATA",JSON.stringify(P)),a({type:"UPDATE",payload:{list:P.todoList,loading:!1}}),E(),i&&i()}else x.post("/todos",{...r,deadline:T(r.deadline).format("YYYY-MM-DD"),operationSource:"h5",detail:p,keyBase:b,ivBase:w}).then(()=>{a({type:"UPDATE",payload:{loading:!1}}),E(),i&&i()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},X=(r,i,p)=>{a({type:"UPDATE",payload:{loading:!0}});const{text:b,keyBase:w,ivBase:P}=v(r.detail);if(t){const L=JSON.parse(localStorage.getItem("DATA"));L.todoList=L.todoList.map(Y=>Y.id===i.id?{...Y,name:r.name,detail:b,keyBase:w,ivBase:P,deadline:T(r.deadline).format("YYYY-MM-DD"),tagId:r.tagId}:Y),localStorage.setItem("DATA",JSON.stringify(L)),a({type:"UPDATE",payload:{list:L.todoList,loading:!1}}),E(),p&&p()}else x.patch(`/todos/${i.id}`,{name:r.name,detail:b,keyBase:w,ivBase:P,deadline:T(r.deadline).format("YYYY-MM-DD"),tagId:r.tagId}).then(()=>{a({type:"UPDATE",payload:{loading:!1}}),E(),p&&p()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},ee=r=>{a({type:"UPDATE",payload:{loading:!0}}),x.patch(`/todos/${r.id}`,{isFinish:!0}).then(()=>{E()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},te=r=>{a({type:"UPDATE",payload:{loading:!0}}),x.delete(`/todos/${r.id}`).then(()=>{E()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},ae=r=>{a({type:"UPDATE",payload:{loading:!0}}),x.patch(`/todos/${r.id}`,{isFinish:!1}).then(()=>{E()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},se=()=>{localStorage.setItem("token",""),m("/ndzy-todos/"),window.location.reload()},oe=r=>{a({type:"UPDATE",payload:{loading:!0}}),x.post("/users/login",{...r}).then(i=>{a({type:"UPDATE",payload:{loading:!1}}),i&&i.data&&i.data.token&&(localStorage.setItem("token",i.data.token),m("/ndzy-todos/"),window.location.reload())}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},re=(r,i)=>{a({type:"UPDATE",payload:{loading:!0}}),x.post("/users/register",{...r}).then(p=>{a({type:"UPDATE",payload:{loading:!1}}),p.status===0&&i&&i()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},ne=r=>{a({type:"UPDATE",payload:{loading:!0}}),x.delete(`/tags/${r}`).then(()=>{D()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},le=()=>{n&&(a({type:"UPDATE",payload:{loading:!0}}),x.post("/tags",{name:n}).then(()=>{o(""),D()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})}))},H=async()=>{a({type:"UPDATE",payload:{loading:!0}}),h(),x.get("/users").then(r=>{a({type:"UPDATE",payload:{loading:!1}}),d(r.data)}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},ie=r=>{a({type:"UPDATE",payload:{loading:!0}}),x.delete(`/users/${r.id}`).then(()=>{H()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},k=()=>{a({type:"UPDATE",payload:{loading:!0}}),x.get("/records").then(r=>{a({type:"UPDATE",payload:{records:r.data.map(i=>({...i,txt:O(i.txt,i.keyBase,i.ivBase)})),loading:!1}})}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})};return{inputValue:n,users:l,initUser:h,initTags:D,createTodo:j,editTodo:X,goPage:m,getAllTodo:E,finishTodo:ee,delTodo:te,recoverTodo:ae,signOut:se,login:oe,register:re,delTag:ne,handleCreateTag:le,setInputValue:o,getUsers:H,delUser:ie,isLocal:t,switchData:()=>{localStorage.getItem("USE_LOCAL_DATA")==="0"?localStorage.setItem("USE_LOCAL_DATA","1"):localStorage.setItem("USE_LOCAL_DATA","0"),window.location.reload()},switchService:()=>{localStorage.getItem("USE_LOCAL_SERVICE")==="0"?localStorage.setItem("USE_LOCAL_SERVICE","1"):localStorage.setItem("USE_LOCAL_SERVICE","0"),window.location.reload()},delLocalData:r=>{const i=JSON.parse(localStorage.getItem("DATA"));i.todoList=i.todoList.filter(p=>p.id!==r),localStorage.setItem("DATA",JSON.stringify(i)),a({type:"UPDATE",payload:{list:i.todoList,loading:!1}}),E()},getAllRecord:k,addRecord:r=>{a({type:"UPDATE",payload:{loading:!0}});const{text:i,keyBase:p,ivBase:b}=v(r.txt);x.post("/records",{...r,txt:i,keyBase:p,ivBase:b}).then(()=>{a({type:"UPDATE",payload:{loading:!1}}),k()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},updateRecord:(r,i)=>{a({type:"UPDATE",payload:{loading:!0}});const{text:p,keyBase:b,ivBase:w}=v(i.txt);x.patch(`/records/${r}`,{name:i.name,txt:p,keyBase:b,ivBase:w,txtInfo:i.txtInfo}).then(()=>{a({type:"UPDATE",payload:{loading:!1}}),k()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})},delRecord:r=>{a({type:"UPDATE",payload:{loading:!0}}),x.delete(`/records/${r}`).then(()=>{k()}).catch(()=>{a({type:"UPDATE",payload:{loading:!1}})})}}};Ie.registerModule(be);function Re({value:t,onChange:s}){const[a,n]=u.useState(null),[o,l]=u.useState("");u.useEffect(()=>{l(t)},[t]);const d={},m={placeholder:"请输入内容..."};return u.useEffect(()=>()=>{a!=null&&(a.destroy(),n(null))},[a]),e.jsx(e.Fragment,{children:e.jsxs("div",{style:{border:"1px solid #ccc",zIndex:100},children:[e.jsx(Ue,{editor:a,defaultConfig:d,mode:"default",style:{borderBottom:"1px solid #ccc"}}),e.jsx(Ce,{defaultConfig:m,value:o,onCreated:n,onChange:h=>{l(h.getHtml()),s(h.getHtml())},mode:"default",style:{overflowY:"hidden",minHeight:330}})]})})}const B=t=>{const{createTodo:s,editTodo:a,isLocal:n}=C(),{state:o}=u.useContext(S),l=d=>t.id?a(d,{id:t.id},t.onClose):s(d,t.onClose);return e.jsxs(c,{initialValues:{name:t.name,deadline:t.deadline?T(t.deadline):T(),detail:t.detail,tagId:t.tagId},preserve:!1,name:"edit",onFinish:l,scrollToFirstError:!0,children:[e.jsx(c.Item,{name:"name",label:"名称",rules:[{required:!0,message:"名称不能为空"}],children:e.jsx(A.TextArea,{rows:1})}),e.jsx(c.Item,{name:"deadline",label:"终止时间",rules:[{required:!0,message:"终止时间不能为空"}],children:e.jsx(ue,{className:"w-100",format:"YYYY-MM-DD",disabledDate:Ne})}),e.jsx(c.Item,{name:"detail",label:"详情",rules:[{required:!0,message:"详情不能为空"}],children:e.jsx(Re,{})}),e.jsx(c.Item,{name:"tagId",label:"标签",rules:[{required:!n,message:"请选择一个标签"}],children:e.jsx(N,{options:o.tags.map(d=>({label:`${d.name}-(${d.userName})`,value:d.id}))})}),e.jsx(c.Item,{children:e.jsx(he,{offsetBottom:16,children:e.jsx(g,{loading:o.loading,type:"primary",htmlType:"submit",children:t.id?"保存":"创建"})})})]})},Ye=()=>{const t=u.useRef(null),s=u.useRef(null),{inputValue:a,delTag:n,handleCreateTag:o,setInputValue:l}=C(),{state:d}=u.useContext(S),[m]=Z(d.tags,{containerTarget:t,wrapperTarget:s,itemHeight:60,overscan:10});return e.jsxs("div",{children:[e.jsxs(U.Compact,{className:"w-100",children:[e.jsx(A,{placeholder:"请输入",value:a,onChange:h=>l(h.target.value)}),e.jsx(g,{loading:d.loading,type:"primary",onClick:o,children:"添加"})]}),e.jsx("div",{ref:t,style:{height:window.innerHeight/2,overflow:"auto",marginTop:16},children:e.jsx("div",{ref:s,children:m.map(h=>{var D;return e.jsx("div",{style:{height:52,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100",children:[e.jsxs("div",{className:"between",children:[h.data.name,((D=d.user)==null?void 0:D.role)==="0"&&e.jsx(R,{title:"删除将无法恢复,确定删除?",onConfirm:()=>n(h.data.id),children:e.jsx(g,{children:" 删除"})})]}),e.jsx("div",{children:e.jsx(U,{children:e.jsxs("span",{children:["创建人：",h.data.userName||"--"]})})})]})},h.data.id)})})})]})},_e=({children:t,...s})=>u.isValidElement(t)?u.cloneElement(t,{...s}):t,I=({title:t,btnName:s,children:a,...n})=>{const[o,l]=we({open:!1});return e.jsxs(e.Fragment,{children:[e.jsx(g,{type:"link",onClick:()=>l({open:!0}),children:s}),e.jsx(xe,{destroyOnClose:!0,open:o.open,title:t,placement:"right",width:"100%",onClose:()=>l({open:!1}),children:e.jsx(_e,{onClose:()=>l({open:!1}),...n,children:o&&a})})]})},Oe=()=>{const{login:t}=C(),{state:s}=u.useContext(S);return e.jsxs(c,{...F,name:"login",onFinish:t,scrollToFirstError:!0,children:[e.jsx(c.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(A,{className:"w-100"})}),e.jsx(c.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(A.Password,{})}),e.jsx(c.Item,{...V,children:e.jsx(g,{loading:s.loading,type:"primary",htmlType:"submit",children:"登录"})})]})},Be=({onClose:t})=>{const{register:s}=C(),{state:a}=u.useContext(S);return e.jsxs(c,{...F,name:"register",onFinish:n=>s(n,t),scrollToFirstError:!0,children:[e.jsx(c.Item,{name:"nickname",label:"昵称",rules:[{required:!0,message:"请输入你的昵称!",whitespace:!0}],children:e.jsx(A,{})}),e.jsx(c.Item,{name:"mobile",label:"手机号",rules:[{required:!0,message:"请输入你的手机号!"}],children:e.jsx(A,{className:"w-100"})}),e.jsx(c.Item,{name:"password",label:"密码",rules:[{required:!0,message:"请输入密码!"}],hasFeedback:!0,children:e.jsx(A.Password,{})}),e.jsx(c.Item,{name:"confirm",label:"确认密码",dependencies:["password"],hasFeedback:!0,rules:[{required:!0,message:"请再次输入密码!"},({getFieldValue:n})=>({validator(o,l){return!l||n("password")===l?Promise.resolve():Promise.reject(new Error("两次密码不匹配!"))}})],children:e.jsx(A.Password,{})}),e.jsx(c.Item,{...V,children:e.jsx(g,{loading:a.loading,type:"primary",htmlType:"submit",children:"注册"})})]})},Me=()=>{const t=u.useRef(null),s=u.useRef(null),{users:a,delUser:n,getUsers:o}=C(),{state:l}=u.useContext(S),[d]=Z(a,{containerTarget:t,wrapperTarget:s,itemHeight:60,overscan:10});return G(()=>{o()}),e.jsx("div",{ref:t,style:{height:window.innerHeight/2,overflow:"auto"},children:e.jsx("div",{ref:s,children:d.map(m=>{var h;return e.jsx("div",{style:{height:52,display:"flex",justifyContent:"center",alignItems:"center",border:"1px solid #e8e8e8",marginBottom:8},children:e.jsxs("div",{className:"between w-100",children:[e.jsxs("div",{className:"between",children:["用户名：",m.data.nickname,((h=l.user)==null?void 0:h.role)==="0"&&e.jsx(R,{title:"删除将无法恢复,确定删除?",onConfirm:()=>n(m.data),children:e.jsx(g,{children:" 删除"})})]}),e.jsx("div",{children:e.jsxs(U,{children:[e.jsxs("span",{children:["创建日期：",T(m.data.createdAt).subtract(8,"h").format("YYYY-MM-DD")]}),e.jsxs("span",{children:["更新日期：",T(m.data.updatedAt).subtract(8,"h").format("YYYY-MM-DD")]})]})})]})},m.data.id)})})})},Fe=({onClose:t})=>{const{getAllTodo:s}=C(),{state:a}=u.useContext(S);return e.jsxs(c,{initialValues:{operationSource:"h5",isFinish:"0"},...F,name:"search",onFinish:n=>{s(n),t()},scrollToFirstError:!0,children:[e.jsx(c.Item,{name:"name",label:"名称",children:e.jsx(A,{className:"w-100"})}),e.jsx(c.Item,{name:"tagId",label:"标签",children:e.jsx(N,{className:"w-100",options:a.tags.map(n=>({label:`${n.name}-(${n.userName})`,value:n.id}))})}),e.jsx(c.Item,{name:"operationSource",label:"来源",children:e.jsx(N,{className:"w-100",options:[{label:"h5",value:"h5"},{label:"微信",value:"wx"}]})}),e.jsx(c.Item,{name:"isFinish",label:"状态",children:e.jsx(N,{className:"w-100",options:[{label:"进行中",value:"0"},{label:"已完成",value:"1"}]})}),e.jsx(c.Item,{...V,children:e.jsx(g,{loading:a.loading,type:"primary",htmlType:"submit",children:"搜索"})})]})},{Paragraph:J}=ge,Ve=()=>{const[t]=c.useForm(),{getAllRecord:s,addRecord:a,delRecord:n}=C(),{state:o}=u.useContext(S);q(()=>{s()},[]),q(()=>{t.setFieldsValue({name:"",txt:"",txtInfo:""})},[o.records]);const l=m=>{m&&a(m)},d=[{title:"名称",dataIndex:"name",width:60,render:m=>e.jsx(J,{copyable:!0,children:m})},{title:"txt",dataIndex:"txt",width:120,render:m=>e.jsx(J,{copyable:!0,children:m})},{title:"描述",dataIndex:"txtInfo",width:20},{title:"操作",width:20,fixed:"right",render:(m,h)=>{var D;return((D=o.user)==null?void 0:D.role)==="0"&&e.jsx(R,{title:"删除将无法恢复,确定删除?",onConfirm:()=>n(h.id),children:e.jsx(Pe,{})})}}];return e.jsxs("div",{children:[e.jsxs(c,{variant:"filled",style:{maxWidth:600},onFinish:l,form:t,children:[e.jsx(c.Item,{label:"name",name:"name",rules:[{required:!0,message:"不能为空"}],children:e.jsx(A,{placeholder:"请输入"})}),e.jsx(c.Item,{label:"txt",name:"txt",rules:[{required:!0,message:"不能为空"}],children:e.jsx(A,{placeholder:"请输入"})}),e.jsx(c.Item,{label:"txtInfo",name:"txtInfo",children:e.jsx(A,{placeholder:"请输入"})}),e.jsx(c.Item,{wrapperCol:{offset:6,span:16},children:e.jsx(g,{type:"primary",htmlType:"submit",loading:o.loading,children:"添加"})})]}),e.jsx(K,{virtual:!0,columns:d,scroll:{x:2e3,y:600},rowKey:"id",dataSource:o.records,pagination:!1,locale:{emptyText:e.jsx("div",{className:"center",children:"暂无待办事项"})}})]})},{Header:He,Content:qe}=W,$e=()=>{const{signOut:t,getAllTodo:s,switchData:a,switchService:n}=C(),{state:o}=u.useContext(S),l=[{key:"0",label:e.jsx(I,{title:"标签",btnName:"标签",children:e.jsx(Ye,{})})},{key:"1",label:e.jsx(I,{title:"登陆",btnName:"登陆",children:e.jsx(Oe,{})})},{key:"2",label:e.jsx(I,{title:"注册",btnName:"注册",children:e.jsx(Be,{})})},{key:"3",label:o.user&&o.user.role==="0"&&e.jsx(I,{title:"用户管理",btnName:"用户管理",children:e.jsx(Me,{})})},{key:"4",label:e.jsx(g,{type:"link",onClick:t,children:"登出"})},{key:"5",label:e.jsx(g,{type:"link",onClick:n,children:localStorage.getItem("USE_LOCAL_SERVICE")==="0"?"本地环境":"线上环境"})},{key:"6",label:e.jsx(g,{type:"link",onClick:a,children:localStorage.getItem("USE_LOCAL_DATA")==="0"?"本地数据":"接口数据"})}];return e.jsxs(W,{className:"ndzy-layout",children:[e.jsx(He,{className:"ndzy-header",children:e.jsxs(U,{className:"mb-16",children:[o.user?e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:o.user.name||o.user.nickname}):e.jsx("div",{style:{minWidth:33},className:"sky-blue center",children:"游客"}),e.jsx(I,{title:"record",btnName:"record",children:e.jsx(Ve,{})}),e.jsx(I,{title:"新建",btnName:"新建",children:e.jsx(B,{})}),e.jsx(I,{title:"搜索",btnName:"搜索",children:e.jsx(Fe,{})}),e.jsx(g,{type:"link",onClick:()=>s(),children:"重置"}),e.jsx(ye,{menu:{items:l},children:e.jsx("a",{onClick:d=>d.preventDefault(),children:"其他"})})]})}),e.jsx(qe,{children:e.jsx("div",{className:"layout-content p-16",children:e.jsx(Ee,{})})})]})},ze=({value:t})=>{const s=M();return e.jsx("div",{style:{padding:"0 8px"},id:`preview-${s}`,className:"ndzy-preview",dangerouslySetInnerHTML:{__html:t}})},Je=t=>e.jsxs(I,{title:"查看",btnName:"查看",children:[e.jsx(ze,{value:t.detail}),e.jsx("div",{children:e.jsxs(U,{children:[e.jsxs("span",{style:{color:"blue"},children:["创建人：",t.userName||"--"]}),e.jsxs("span",{style:{color:"green"},children:["标签：",t.tagName||"--"]}),e.jsxs("span",{style:{color:"red"},children:["终止日期：",T(t.deadline).format("YYYY-MM-DD")]})]})}),e.jsx("div",{children:e.jsxs(U,{children:[e.jsxs("span",{children:["创建日期：",T(t.createdAt).subtract(8,"h").format("YYYY-MM-DD")]}),e.jsxs("span",{children:["更新日期：",T(t.updatedAt).subtract(8,"h").format("YYYY-MM-DD")]})]})})]}),Ke=()=>{const{state:t}=u.useContext(S),{initUser:s,initTags:a,getAllTodo:n,finishTodo:o,delTodo:l,recoverTodo:d,delLocalData:m,isLocal:h}=C();G(()=>{s(),a(),n()});const D=[{title:"名称",dataIndex:"name",width:80},{title:"进度",dataIndex:"deadline",width:80,render:(E,j)=>{if(Number(j.isFinish)===0)return e.jsx("span",{style:{color:"red"},children:"处理中"});if(Number(j.isFinish)===1)return e.jsx("span",{style:{color:"green"},children:"已完成"})}},{title:"截止日期",dataIndex:"deadline",width:80},{title:"标签",dataIndex:"tagName",width:80},{title:"用户",dataIndex:"userName",width:80},{title:"创建时间",dataIndex:"createdAt",width:120},{title:"更新时间",dataIndex:"updatedAt",width:120},{title:"操作",width:100,fixed:"right",render:(E,j)=>e.jsxs(U,{children:[e.jsx(Je,{...j}),h&&e.jsx(I,{title:"编辑",btnName:"编辑",...j,children:e.jsx(B,{})}),h&&e.jsx(g,{type:"link",onClick:()=>m(j.id),children:"删除"}),h&&e.jsx(g,{type:"link",onClick:()=>{},children:"同步"}),Number(j.isFinish)===0?e.jsxs(U,{children:[e.jsx(I,{title:"编辑",btnName:"编辑",...j,children:e.jsx(B,{})}),e.jsx(g,{type:"link",onClick:()=>o(j),children:"完成"})]}):Number(j.isFinish)===1?e.jsxs(U,{children:[e.jsx(g,{type:"link",onClick:()=>d(j),children:"恢复"}),e.jsx(R,{title:"删除将无法恢复,确定删除?",onConfirm:()=>l(j),children:e.jsx(g,{type:"link",children:" 删除"})})]}):null]})}];return e.jsxs("div",{children:[e.jsx("div",{className:"center",children:t.loading&&e.jsx(fe,{})}),e.jsx(K,{virtual:!0,columns:D,scroll:{x:2e3,y:600},rowKey:"id",dataSource:t.list,pagination:!1,locale:{emptyText:e.jsx("div",{className:"center",children:"暂无待办事项"})}})]})},We=()=>e.jsx("div",{className:"center",children:e.jsxs("div",{children:[e.jsx("h2",{children:"页面不存在"}),e.jsx("p",{children:e.jsx(pe,{to:"/",children:"返回首页"})})]})}),Ze=()=>{const[t,s]=u.useReducer(ke,Q);return e.jsx(je,{locale:Ae,children:e.jsx(S.Provider,{value:{state:t,dispatch:s},children:e.jsx(Se,{children:e.jsxs(_,{path:"/ndzy-todos/",element:e.jsx($e,{}),children:[e.jsx(_,{index:!0,element:e.jsx(Ke,{})}),e.jsx(_,{path:"*",element:e.jsx(We,{})})]})})})})};ce.createRoot(document.getElementById("root")).render(e.jsx(de.StrictMode,{children:e.jsx(me,{children:e.jsx(Ze,{})})}));
